import logging
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes

class HAI_Calculator:
    """
    –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ò–°–ú–ü —Å –Ω–æ—Ä–º–∞—Ç–∏–≤–∞–º–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏.
    –û–±–Ω–æ–≤–ª–µ–Ω–æ: –û–ê–†–ò–¢, –•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ, –û–±—â–µ–ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä.
    """

    # –ù–æ—Ä–º–∞—Ç–∏–≤—ã –ø–æ –†–§ (–≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ)
    NORMS_RU = {
        "clabsi": {
            "–û–ê–†–ò–¢": 3.0,
            "–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ": 5.0,
            "–û–±—â–µ–ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä": 4.0,
        },
        "vap": {
            "–û–ê–†–ò–¢": 10.0,
            "–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ": 8.0,
            "–û–±—â–µ–ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä": 6.0,
        },
        "cauti": {
            "–û–ê–†–ò–¢": 7.0,
            "–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ": 6.0,
            "–û–±—â–µ–ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä": 5.0,
        },
        "ssi": {
            "–ê–ø–ø–µ–Ω–¥—ç–∫—Ç–æ–º–∏—è": 8.0,
            "–ö–æ–ª–æ—Ä–µ–∫—Ç–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏": 15.0,
            "–ü—Ä–æ—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—Å—Ç–∞–≤–∞": 2.0,
        },
        "cdiff": 5.0,           # –†–æ—Å—Å–∏—è (–Ω–∞ 10 000 –∫–æ–π–∫–æ-–¥–Ω–µ–π)
        "overall": 5.0,         # –û–±—â–∞—è —á–∞—Å—Ç–æ—Ç–∞ –ò–°–ú–ü –≤ –†–§ (–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–æ)
    }

    @staticmethod
    def clabsi_rate(cases: int, days: int) -> float:
        return (cases / days) * 1000 if days > 0 else 0.0

    @staticmethod
    def vap_rate(cases: int, days: int) -> float:
        return (cases / days) * 1000 if days > 0 else 0.0

    @staticmethod
    def cauti_rate(cases: int, days: int) -> float:
        return (cases / days) * 1000 if days > 0 else 0.0

    @staticmethod
    def ssi_rate(cases: int, ops: int) -> float:
        return (cases / ops) * 100 if ops > 0 else 0.0

    @staticmethod
    def c_diff_rate(cases: int, patient_days: int) -> float:
        return (cases / patient_days) * 10000 if patient_days > 0 else 0.0

    @staticmethod
    def overall_hai_rate(total_hai_cases: int, total_admissions: int) -> float:
        return (total_hai_cases / total_admissions) * 100 if total_admissions > 0 else 0.0

    @classmethod
    def interpret(cls, indicator: str, value: float, context: str = None) -> str:
        """–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ø–æ –Ω–æ—Ä–º–∞—Ç–∏–≤–∞–º –†–§"""
        if indicator in ("clabsi", "vap", "cauti"):
            norm = cls.NORMS_RU[indicator].get(context)
        elif indicator == "ssi":
            norm = cls.NORMS_RU["ssi"].get(context)
        elif indicator == "cdiff":
            norm = cls.NORMS_RU["cdiff"]
        elif indicator == "overall":
            norm = cls.NORMS_RU["overall"]
        else:
            return "‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å"

        if norm is None:
            return f"‚ö†Ô∏è –ù–µ—Ç –Ω–æ—Ä–º—ã –¥–ª—è ¬´{context}¬ª"
        if value <= norm:
            unit = "%" if indicator in ("ssi", "overall") else ""
            return f"üü¢ –í –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã (‚â§ {norm}{unit})"
        else:
            unit = "%" if indicator in ("ssi", "overall") else ""
            return f"üî¥ –í—ã—à–µ –Ω–æ—Ä–º—ã (–Ω–æ—Ä–º–∞ ‚â§ {norm}{unit})"

# === –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ===
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', level=logging.INFO
)
logger = logging.getLogger(__name__)

# === –°—Å—ã–ª–∫–∏ ===
PROGRAM_LINK = "https://disk.yandex.ru/i/cbNiheeSFy6NvQ"
PROTOCOLS_LINK = "https://disk.yandex.ru/d/jthWuv1YfJatPw"
CHART_IMAGE_URL = "https://disk.yandex.ru/i/WKywmfTxGmfZFg"

# === –ú–µ–Ω—é ===
MAIN_MENU = [
    "–ò–°–ú–ü",
    "–°–∞–Ω—ç–ø–∏–¥—Ä–µ–∂–∏–º –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è—Ö",
    "–î–µ–∑–∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è—Ö",
    "–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥",
    "–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –±–æ–ª—å–Ω–æ–≥–æ",
    "–ê–≤–∞—Ä–∏–π–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏",
    "–ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫",
    "–°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏",
    "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å",
    "–û—Å–æ–±–æ –æ–ø–∞—Å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏",
    "–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢",
]

ISM_MENU = [
    "–ö–æ–º–∏—Å—Å–∏—è –ø–æ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–µ –ò–°–ú–ü",
    "–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ò–°–ú–ü",
    "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –ò–°–ú–ü —É –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞",
    "–ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã",
    "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª—É—á–∞–µ–≤ –ò–°–ú–ü",
    "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –ò–°–ú–ü",
    "–í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ò–°–ú–ü"
]

CRITERIA_MENU = ["–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤", "–£ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤"]
SOS_MENU = [
    "–ò–ê–ò - –∏–º–ø–ª–∞–Ω—Ç–∞—Ç-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è",
    "–ò–î–ü ‚Äì –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π",
    "–ò–ú–ü - –∏–Ω—Ñ–µ–∫—Ü–∏—è –º–æ—á–µ–≤—ã–≤–æ–¥—è—â–∏—Ö –ø—É—Ç–µ–π",
    "–ò–û–•–í - –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞",
    "–ò–ö - –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –∫—Ä–æ–≤–æ—Ç–æ–∫–∞"
]

IAI_MENU = [
    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ò–ê–ò",
    "–ü—Ä–∏–∑–Ω–∞–∫–∏ –ò–ê–ò",
    "–§–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞ —Ä–∞–∑–≤–∏—Ç–∏—è –ü–ü–ò",
    "–¢–∏–ø—ã –ü–ü–ò",
    "–í–µ—Ä–æ—è—Ç–Ω—ã–µ –ø—É—Ç–∏ –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏—è –ü–ü–ò",
    "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –ò–ê–ò"
]

IDD_MENU = ["–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ò–û–î", "–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ò–û–î", "–î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –ò–û–î"]
IDD_DEF_MENU = [
    "–ü–Ω–µ–≤–º–æ–Ω–∏—è, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏",
    "–¢—Ä–∞—Ö–µ–æ–±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ (–±—Ä–æ–Ω—Ö–∏—Ç, —Ç—Ä–∞—Ö–µ–æ–±—Ä–æ–Ω—Ö–∏—Ç, –±—Ä–æ–Ω—Ö–∏–æ–ª–∏—Ç, —Ç—Ä–∞—Ö–µ–∏—Ç –±–µ–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–Ω–µ–≤–º–æ–Ω–∏–∏)",
    "–ü—Ä–æ—á–∏–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –Ω–∏–∂–Ω–∏—Ö –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π"
]
IDD_CRIT_MENU = [
    "–ø–Ω–µ–≤–º–æ–Ω–∏–∏ –±–µ–∑ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è",
    "–ø–Ω–µ–≤–º–æ–Ω–∏–∏ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ",
    "–ò–í–õ-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–Ω–µ–≤–º–æ–Ω–∏–∏"
]

IMP_MENU = ["–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ò–ú–ü", "–í–∏–¥—ã –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ò–ú–ü", "–î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –ò–ú–ü"]
IMP_TYPES_MENU = [
    "–º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è —Å–∏–º–ø—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ò–ú–ü",
    "–Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–∏–º–ø—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ò–ú–ü",
    "–∫–∞—Ç–µ—Ç–µ—Ä-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ò–ú–ü"
]

IOHV_MENU = ["–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ò–û–•–í", "–í–∏–¥—ã –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ò–û–•–í", "–î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –ò–û–•–í"]
IOHV_TYPES_MENU = [
    "–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞",
    "–ì–ª—É–±–æ–∫–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞",
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –æ—Ä–≥–∞–Ω–∞ –∏–ª–∏ –ø–æ–ª–æ—Å—Ç–∏"
]

IK_MENU = ["–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ò–ö", "–í–∏–¥—ã –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ò–ö", "–î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –ò–ö"]
IK_TYPES_MENU = [
    "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞",
    "–ö–∞—Ç–µ—Ç–µ—Ä-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞ (–ö–ê–ò–ö)",
    "–ò–ö —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –¶–í–ö (–±–µ–∑ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã—Å–µ–≤–∞ –∏–∑ –∫—Ä–æ–≤–∏)",
    "–ò–ö –ü–í–ö (–±–µ–∑ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã—Å–µ–≤–∞ –∏–∑ –∫—Ä–æ–≤–∏)",
    "–ì–µ–Ω–µ—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ò–ö, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –¶–í–ö (–±–µ–∑ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã—Å–µ–≤–∞ –∏–∑ –∫—Ä–æ–≤–∏)",
    "–ì–µ–Ω–µ—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ò–ö, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –ü–í–ö (–±–µ–∑ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã—Å–µ–≤–∞ –∏–∑ –∫—Ä–æ–≤–∏)",
    "–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –¶–í–ö",
    "–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –ü–í–ö"

]

MM_MENU = [
    "–ì—Ä—É–ø–ø—ã –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ (–ø–∞—Ü–∏–µ–Ω—Ç—ã)",
    "–í–∏–¥ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ (–ø–∞—Ü–∏–µ–Ω—Ç—ã)",
    "–ü—Ä–æ—Ñ–∏–ª–∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤",
    "–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã",
    "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å",
    "–ü–µ—Ä–µ—á–µ–Ω—å –±–∏–æ–º–∞—Ç–µ—Ä–∏–∞–ª–∞ –¥–ª—è –ø–ª–∞–Ω–æ–≤–æ–≥–æ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è",
    "–ì–æ–¥–æ–≤–æ–π –æ—Ç—á–µ—Ç –ú–ú",
    "–û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–µ–∑–∏–Ω—Ñ–∏—Ü–∏—Ä—É—é—â–∏—Ö —Å—Ä–µ–¥—Å—Ç–≤",
    "–ß–∞—Å—Ç–æ—Ç–∞ ESCAPE-–ø–∞—Ç–æ–≥–µ–Ω–æ–≤",
    "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–∏–∫—Ä–æ–±–Ω–æ–≥–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è",
    "–ü–∞—Ü–∏–µ–Ω—Ç—ã —Å –ø–æ–ª–∏—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º–∏ —à—Ç–∞–º–º–∞–º–∏"
]

MM_GROUP_MO_MENU = ["2024 –≥–æ–¥ –≥—Ä—É–ø–ø—ã –ú–û", "2025 –≥–æ–¥ –≥—Ä—É–ø–ø—ã –ú–û"]
MM_SPECIES_MO_MENU = ["2024 –≥–æ–¥ –≤–∏–¥ –ú–û", "2025 –≥–æ–¥ –≤–∏–¥ –ú–û"]
MM_RESIST_MENU = ["2024 –ø—Ä —Ä–µ–∑–∏—Å—Ç", "2025 –ø—Ä —Ä–µ–∑–∏—Å—Ç"]
MM_ESCAPE_MENU = ["2024 Escape", "2025 Escape"]

# === –ê–≤–∞—Ä–∏–π–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ ===
AS_MENU = [
    "–ê–ª–≥–æ—Ä–∏—Ç–º –º–µ—Ä –ª–∏—á–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏",
    "–ê–ª–≥–æ—Ä–∏—Ç–º —É—á–µ—Ç–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–≤–∞—Ä–∏–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π",
    "–°–æ—Å—Ç–∞–≤ —É–∫–ª–∞–¥–∫–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –ø–∞—Ä–µ–Ω—Ç–µ—Ä–∞–ª—å–Ω—ã—Ö –∏–Ω—Ñ–µ–∫—Ü–∏–π",
    "–î–æ—Ç–µ—Å—Ç–æ–≤–æ–µ –∏ –ø–æ—Å–ª–µ—Ç–µ—Å—Ç–æ–≤–æ–µ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —ç–∫—Å–ø—Ä–µ—Å—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–∞ –í–ò–ß-–∏–Ω—Ñ–µ–∫—Ü–∏—é",
    "–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –í–ò–ß-–∏–Ω—Ñ–µ–∫—Ü–∏—é",
    "–ñ—É—Ä–Ω–∞–ª —É—á–µ—Ç–∞ –∞–≤–∞—Ä–∏–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π",
    "–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø–æ —Å–Ω–∏–∂–µ–Ω–∏—é —á–∏—Å–ª–∞ –ê–°"
]

AS_CONSULT_MENU = [
    "–î–æ—Ç–µ—Å—Ç–æ–≤–æ–µ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "–ü–æ—Å–ª–µ—Ç–µ—Å—Ç–æ–≤–æ–µ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "–°—Ö–µ–º–∞ –ø–æ—Å–ª–µ—Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ",
    "–°—Ö–µ–º–∞ –ø–æ—Å–ª–µ—Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ"
]

DETECTED_MENU = ["–°—Ç–∞—Ü–∏–æ–Ω–∞—Ä + –•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ", "–û–ê–†–ò–¢", "–û–±–æ–±—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"]

# === –ú–µ–Ω—é: –û—Å–æ–±–æ –æ–ø–∞—Å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ ===
OOI_MENU = [
    "–ü—Ä–æ—Ç–∏–≤–æ—ç–ø–∏–¥–µ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
    "–°–ò–ó –¥–ª—è –û–û–ò",
    "–õ–µ—á–µ–Ω–∏–µ –∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –ø—Ä–∏ –û–û–ò",
    "–ú–µ—Ä—ã –ª–∏—á–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤",
    "–ó–∞–±–æ—Ä –±–∏–æ–º–∞—Ç–µ—Ä–∏–∞–ª–∞ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –û–û–ò",
    "–†–µ–∂–∏–º—ã –æ–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π –ø—Ä–∏ –û–û–ò"
]

OOI_MEASURES_MENU = [
    "–û–±—â–∏–π –ø–ª–∞–Ω –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π",
    "–ü–µ—Ä–≤–∏—á–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è"
]

OOI_PPE_MENU = [
    "–í–∏–¥—ã –∫–æ—Å—Ç—é–º–æ–≤",
    "–°–ª—É—á–∞–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ—Å—Ç—é–º–æ–≤",
    "–ü–æ—Ä—è–¥–æ–∫ –Ω–∞–¥–µ–≤–∞–Ω–∏—è –∏ —Å–Ω—è—Ç–∏—è –∫–æ—Å—Ç—é–º–∞ ¬´1 —Ç–∏–ø–∞¬ª",
    "–ü–æ—Ä—è–¥–æ–∫ –Ω–∞–¥–µ–≤–∞–Ω–∏—è –∏ —Å–Ω—è—Ç–∏—è ¬´–ö–≤–∞—Ä—Ü-–ú1¬ª"
]

OOI_PPE_TYPES_MENU = [
    "–ö–æ—Å—Ç—é–º 1 —Ç–∏–ø–∞",
    "–ö–æ—Å—Ç—é–º 2 —Ç–∏–ø–∞",
    "–ö–æ—Å—Ç—é–º 3 —Ç–∏–ø–∞",
    "–ö–æ—Å—Ç—é–º 4 —Ç–∏–ø–∞",
    "–ö–æ—Å—Ç—é–º –ö–≤–∞—Ä—Ü-–ú1"
]

OOI_TREATMENT_MENU = [
    "–°—Ö–µ–º–∞ —Ç–µ—Ä–∞–ø–∏–∏ –±–æ–ª—å–Ω—ã—Ö –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏",
    "–°—Ö–µ–º–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –ø—Ä–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–º –≤–æ–∑–±—É–¥–∏—Ç–µ–ª–µ",
    "–ß—É–º–∞",
    "–•–æ–ª–µ—Ä–∞",
    "–ü–∞—Ç–æ–≥–µ–Ω–Ω—ã–π –≥—Ä–∏–ø–ø",
    "–¢—Ä–æ–ø–∏—á–µ—Å–∫–∞—è –º–∞–ª—è—Ä–∏—è",
    "–õ–∏—Ö–æ—Ä–∞–¥–∫–∞ –†–∏—Ñ—Ç-–í–∞–ª–ª–∏",
    "–ú–µ–Ω–∏–Ω–≥–æ–∫–æ–∫–∫–æ–≤–∞—è –±–æ–ª–µ–∑–Ω—å"
]

OOI_PERSONAL_MENU = [
    "–ú–µ—Ä—ã",
    "–£–∫–ª–∞–¥–∫–∞ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –û–û–ò"
]

OOI_DECONT_MENU = [
    "–•–æ–ª–µ—Ä–∞",
    "–ß—É–º–∞",
    "–°–∏–±–∏—Ä—Å–∫–∞—è —è–∑–≤–∞",
    "–§–µ–∫–∞–ª–∏–∏, –º–æ–∫—Ä–æ—Ç–∞, —Å—ã–≤–æ—Ä–æ—Ç–∫–∞ –∫—Ä–æ–≤–∏",
    "–í–∏—Ä—É—Å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏",
    "–ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ç–≤–æ—Ä–∞ ¬´–•–ª–æ—Ä–∞–ø–∏–Ω¬ª"
]
# === –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –±–æ–ª—å–Ω–æ–≥–æ ===
INFECT_MENU = [
    "–ü–µ—Ä–≤–∏—á–Ω—ã–µ –ø—Ä–æ—Ç–∏–≤–æ—ç–ø–∏–¥–µ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
    "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –í–ò–ß-–∏–Ω—Ñ–µ–∫—Ü–∏–∏ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞",
    "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –≥–µ–ø–∞—Ç–∏—Ç–∞ –í –∏ –° —É –ø–∞—Ü–∏–µ–Ω—Ç–∞",
    "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—É–±–µ—Ä–∫—É–ª–µ–∑–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞",
    "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è —Å–∞–ª—å–º–æ–Ω–µ–ª–ª–µ–∑–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞",
    "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –ì–µ–ø–∞—Ç–∏—Ç–∞ –ê –∏ –ï",
    "–ü—Ä–æ—Ç–∏–≤–æ—ç–ø–∏–¥–µ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø—Ä–æ—Ç–∏–≤ –ì—Ä–∏–ø–ø, –û–†–í–ò, Covid-19",
    "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –∫–æ—Ä–∏, –∫—Ä–∞—Å–Ω—É—Ö–∏, —ç–ø–∏–¥–ø–∞—Ä–æ—Ç–∏—Ç–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞",
    "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –∫–æ–∫–ª—é—à–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞",
    "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –¥–∏—Ñ—Ç–µ—Ä–∏–∏ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞",
    "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –º–µ–Ω–∏–Ω–≥–æ–∫–æ–∫–∫–æ–≤–æ–π –∏–Ω—Ñ–µ–∫—Ü–∏–∏",
    "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–Ω–µ–≤–º–æ–Ω–∏–∏ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞",
    "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–µ–ø—Ç–æ–∫–æ–∫–∫–æ–≤–æ–π –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –≥—Ä—É–ø–ø—ã –ê —É –ø–∞—Ü–∏–µ–Ω—Ç–∞",
    "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –ª–µ–≥–∏–æ–Ω–µ–ª–ª–µ–∑–∞",
    "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –≥–Ω–æ–π–Ω–æ-–≤–æ—Å–ø–∞–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π",
]
# === –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢ ===
AMT_MENU = [
    "–ò–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–π —ç–Ω–¥–æ–∫–∞—Ä–¥–∏—Ç",
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –∫–æ–∂–∏ –∏ –º—è–≥–∫–∏—Ö —Ç–∫–∞–Ω–µ–π",
    "–≠–Ω—Ç–µ—Ä–æ–∫–æ–ª–∏—Ç, –≤—ã–∑–≤–∞–Ω–Ω—ã–π Clostridioides difficille",
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–æ–≤ –±—Ä—é—à–Ω–æ–π –ø–æ–ª–æ—Å—Ç–∏",
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –º–æ—á–µ–≤—ã–≤–æ–¥—è—â–∏—Ö –ø—É—Ç–µ–π",
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–æ–≤ –º–∞–ª–æ–≥–æ —Ç–∞–∑–∞",
    "–ù–æ–∑–æ–∫–æ–º–∏–∞–ª—å–Ω–∞—è –ø–Ω–µ–≤–º–æ–Ω–∏—è",
    "–°–µ–ø—Å–∏—Å",
    "–§–∏–±—Ä–∏–ª—å–Ω–∞—è –Ω–µ–π—Ç—Ä–æ–ø–µ–Ω–∏—è",
    "–ò–Ω–≤–∞–∑–∏–≤–Ω—ã–π –∫–∞–Ω–¥–∏–¥–æ–∑",
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –õ–û–†-–æ—Ä–≥–∞–Ω–æ–≤",
]

# === –ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫ ===
HAND_HYGIENE_MENU = [
    "–í–≤–µ–¥–µ–Ω–∏–µ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–∏–≥–∏–µ–Ω—ã —Ä—É–∫",
    "–ü—è—Ç—å –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –≥–∏–≥–∏–µ–Ω—ã —Ä—É–∫ (–ø–æ –í–û–ó)",
    "–ú–µ—Ç–æ–¥–∏–∫–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∏ –≥–∏–≥–∏–µ–Ω—ã —Ä—É–∫",
    "–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤–∞—è –±–∞–∑–∞",
    "–û–±—É—á–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å"
]

HAND_TECHNIQUES_MENU = [
    "–ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫ —Å –º—ã–ª–æ–º –∏ –≤–æ–¥–æ–π / –∞–Ω—Ç–∏—Å–µ–ø—Ç–∏–∫–æ–º",
    "–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫"
]

# === –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ ===
STRAT_MENU = [
    "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ò–ö-–¶–í–ö",
    "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –í–ê–ü",
    "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ö–ê-–ò–ú–í–ü",
    "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ò–û–•–í",
    "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏–Ω—Ñ–µ–∫—Ü–∏—é, –≤—ã–∑–≤–∞–Ω–Ω—É—é Clostridioides difficile",
    "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–±—â—É—é —á–∞—Å—Ç–æ—Ç—É –ò–°–ú–ü",
]

AMT_SUBMENU = ["–°—Ö–µ–º–∞", "–î–æ–∑–∏—Ä–æ–≤–∫–∏"]
AMT_ABD_MENU = ["–°—Ö–µ–º–∞", "–≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è —Ç–µ—Ä–∞–ø–∏—è –∏–Ω–≤–∞–∑–∏–≤–Ω–æ–≥–æ –º–∏–∫–æ–∑–∞", "–î–æ–∑–∏—Ä–æ–≤–∫–∏"]

AMT_IMAGES = {
    "–ò–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–π —ç–Ω–¥–æ–∫–∞—Ä–¥–∏—Ç": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/cOR6sTVnyGIDqQ",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/sA58zTvNdLFWkg",
    },
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –∫–æ–∂–∏ –∏ –º—è–≥–∫–∏—Ö —Ç–∫–∞–Ω–µ–π": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/o8z1AHFnmVZqUg",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/26jcg2fv6Craqw",
    },
    "–≠–Ω—Ç–µ—Ä–æ–∫–æ–ª–∏—Ç, –≤—ã–∑–≤–∞–Ω–Ω—ã–π Clostridioides difficille": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/g5gqxtFQRme4rA",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/xk-HSXwQqYz-ZA",
    },
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–æ–≤ –±—Ä—é—à–Ω–æ–π –ø–æ–ª–æ—Å—Ç–∏": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/yFJ8nMl9iy_TGw",
        "–≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è —Ç–µ—Ä–∞–ø–∏—è –∏–Ω–≤–∞–∑–∏–≤–Ω–æ–≥–æ –º–∏–∫–æ–∑–∞": "https://disk.yandex.ru/i/_unH6TWjt8FRHg",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/hOk8WzAo8xvAGA",
    },
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –º–æ—á–µ–≤—ã–≤–æ–¥—è—â–∏—Ö –ø—É—Ç–µ–π": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/gX1wgTfwGjwzvQ",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/GJqNTd6EMpAacw",
    },
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–æ–≤ –º–∞–ª–æ–≥–æ —Ç–∞–∑–∞": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/QyIlmnkK5UBqTA",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/fSxAjFh1Wr8ujw",
    },
    "–ù–æ–∑–æ–∫–æ–º–∏–∞–ª—å–Ω–∞—è –ø–Ω–µ–≤–º–æ–Ω–∏—è": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/yuq7sNfhmpyRew",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/Jp1SSaLGWfaxKw",
    },
    "–°–µ–ø—Å–∏—Å": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/1Guo3RmdBTNuRQ",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/MUttc5OhwEsnDg",
    },
    "–§–∏–±—Ä–∏–ª—å–Ω–∞—è –Ω–µ–π—Ç—Ä–æ–ø–µ–Ω–∏—è": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/x481dlDzDFXneg",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/bebl7x4-K6wQNA",
    },
    "–ò–Ω–≤–∞–∑–∏–≤–Ω—ã–π –∫–∞–Ω–¥–∏–¥–æ–∑": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/CDU-FVaI-rIsqg",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/070K5T2Yzc-0bQ",
    },
    "–ò–Ω—Ñ–µ–∫—Ü–∏—è –õ–û–†-–æ—Ä–≥–∞–Ω–æ–≤": {
        "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/ndGZstmEcgTE4Q",
        "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/RFoMjt4zQ6YKrw",
    },
}

# === –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞: –ø–æ –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–µ –Ω–∞ —Å—Ç—Ä–æ–∫—É ===
def build_menu(buttons, back=True, home=True):
    menu = [[btn] for btn in buttons]
    bottom = []
    if back:
        bottom.append("–ù–∞–∑–∞–¥")
    if home:
        bottom.append("–í –Ω–∞—á–∞–ª–æ")
    if bottom:
        menu.append(bottom)
    return menu

# === –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π ===
async def reply_safe(update: Update, text: str, reply_markup=None):
    max_len = 4000
    if len(text) <= max_len:
        await update.message.reply_text(text, reply_markup=reply_markup, parse_mode="HTML")
    else:
        parts = [text[i:i + max_len] for i in range(0, len(text), max_len)]
        for part in parts[:-1]:
            await update.message.reply_text(part, parse_mode="HTML")
        await update.message.reply_text(parts[-1], reply_markup=reply_markup, parse_mode="HTML")

# === /start ===
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    mk = ReplyKeyboardMarkup(build_menu(MAIN_MENU), resize_keyboard=True)
    await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:", reply_markup=mk)
    context.user_data["menu_stack"] = ["main"]

# === –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π ===
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text
    stack = context.user_data.setdefault("menu_stack", ["main"])

    if text == "–í –Ω–∞—á–∞–ª–æ":
        stack.clear()
        stack.append("main")
        mk = ReplyKeyboardMarkup(build_menu(MAIN_MENU), resize_keyboard=True)
        await update.message.reply_text("–í—ã –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é.", reply_markup=mk)
        return

    if text == "–ù–∞–∑–∞–¥":
        if len(stack) > 1:
            stack.pop()
        current = stack[-1]
        nav = {
            "main": (MAIN_MENU, "–í—ã –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é."),
            "ism_menu": (MAIN_MENU, "–†–∞–∑–¥–µ–ª –ò–°–ú–ü"),
            "criteria": (ISM_MENU, "–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –≤ –ò–°–ú–ü:"),
            "sos": (ISM_MENU, "–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –≤ –ò–°–ú–ü:"),
            "iai": (SOS_MENU, "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ñ–µ–∫—Ü–∏–∏:"),
            "idd": (SOS_MENU, "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ñ–µ–∫—Ü–∏–∏:"),
            "idd_def": (IDD_MENU, "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ò–û–î:"),
            "idd_crit": (IDD_MENU, "–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ò–û–î:"),
            "imp": (SOS_MENU, "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ñ–µ–∫—Ü–∏–∏:"),
            "imp_types": (IMP_MENU, "–ò–ú–ü:"),
            "iohv": (SOS_MENU, "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ñ–µ–∫—Ü–∏–∏:"),
            "iohv_types": (IOHV_MENU, "–ò–û–•–í:"),
            "ik": (SOS_MENU, "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ñ–µ–∫—Ü–∏–∏:"),
            "ik_types": (IK_MENU, "–ò–Ω—Ñ–µ–∫—Ü–∏–∏ –∫—Ä–æ–≤–æ—Ç–æ–∫–∞:"),
            "detected": (ISM_MENU, "–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –≤ –ò–°–ú–ü:"),
            "oOI_menu": (OOI_MENU, "–û—Å–æ–±–æ –æ–ø–∞—Å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏:"),
            "oOI_measures": (OOI_MEASURES_MENU, "–ü—Ä–æ—Ç–∏–≤–æ—ç–ø–∏–¥–µ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:"),
            "oOI_ppe": (OOI_PPE_MENU, "–°–ò–ó –¥–ª—è –û–û–ò:"),
            "oOI_ppe_types": (OOI_PPE_TYPES_MENU, "–í–∏–¥—ã –∫–æ—Å—Ç—é–º–æ–≤:"),
            "oOI_treatment": (OOI_TREATMENT_MENU, "–õ–µ—á–µ–Ω–∏–µ –∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞:"),
            "oOI_personal": (OOI_PERSONAL_MENU, "–ú–µ—Ä—ã –ª–∏—á–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏:"),
            "oOI_decont": (OOI_DECONT_MENU, "–†–µ–∂–∏–º—ã –æ–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏—è:"),
        }
        if current in nav:
            btns, msg = nav[current]
            mk = ReplyKeyboardMarkup(build_menu(btns), resize_keyboard=True)
            await update.message.reply_text(msg, reply_markup=mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(MAIN_MENU), resize_keyboard=True)
            await update.message.reply_text("–í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.", reply_markup=mk)
            stack.clear()
            stack.append("main")
        return

    # === –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ===
    if stack[-1] == "main":
        if text == "–ò–°–ú–ü":
            stack.append("ism_menu")
            mk = ReplyKeyboardMarkup(build_menu(ISM_MENU), resize_keyboard=True)
            await update.message.reply_text("–†–∞–∑–¥–µ–ª –ò–°–ú–ü:", reply_markup=mk)
        elif text == "–°–∞–Ω—ç–ø–∏–¥—Ä–µ–∂–∏–º –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è—Ö":
            link = "https://disk.yandex.ru/d/_tb-gEeevGXGZQ"
            await update.message.reply_text(f"üìÑ –°–∞–Ω—ç–ø–∏–¥—Ä–µ–∂–∏–º –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è—Ö:\n{link}")
            mk = ReplyKeyboardMarkup(build_menu(MAIN_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é.", reply_markup=mk)
        elif text == "–î–µ–∑–∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è—Ö":
            link = "https://disk.yandex.ru/d/SyYix-yb09jfYQ"
            await update.message.reply_text(f"üìÑ –î–µ–∑–∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è—Ö:\n{link}")
            mk = ReplyKeyboardMarkup(build_menu(MAIN_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é.", reply_markup=mk)
        elif text == "–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥":
            stack.append("mm_menu")
            mk = ReplyKeyboardMarkup(build_menu(MM_MENU), resize_keyboard=True)
            await update.message.reply_text("–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:", reply_markup=mk)
        elif text == "–ê–≤–∞—Ä–∏–π–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏":
            stack.append("as_menu")
            mk = ReplyKeyboardMarkup(build_menu(AS_MENU), resize_keyboard=True)
            await update.message.reply_text("–ê–≤–∞—Ä–∏–π–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏:", reply_markup=mk)
        elif text == "–û—Å–æ–±–æ –æ–ø–∞—Å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏":
            stack.append("oOI_menu")
            mk = ReplyKeyboardMarkup(build_menu(OOI_MENU), resize_keyboard=True)
            await update.message.reply_text("–û—Å–æ–±–æ –æ–ø–∞—Å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏:", reply_markup=mk)
        elif text == "–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –±–æ–ª—å–Ω–æ–≥–æ":
            stack.append("infect_menu")
            mk = ReplyKeyboardMarkup(build_menu(INFECT_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ñ–µ–∫—Ü–∏–∏:", reply_markup=mk)
        elif text == "–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢":
            stack.append("amt_menu")
            mk = ReplyKeyboardMarkup(build_menu(AMT_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢:", reply_markup=mk)
        elif text == "–ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫":
            stack.append("hand_hygiene")
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await update.message.reply_text("–ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫:", reply_markup=mk)
        elif text == "–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢":
            stack.append("amt_menu")
            mk = ReplyKeyboardMarkup(build_menu(AMT_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢:", reply_markup=mk)
        elif text == "–ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫":
            stack.append("hand_hygiene")
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await update.message.reply_text("–ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫:", reply_markup=mk)
        elif text == "–°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏":
            stack.append("strat_menu")
            mk = ReplyKeyboardMarkup(build_menu(STRAT_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞:", reply_markup=mk)
        else:
            await update.message.reply_text("–†–∞–∑–¥–µ–ª –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.")
        return

    # === –ò–°–ú–ü –º–µ–Ω—é ===
    if stack[-1] == "ism_menu":
        if text == "–ö–æ–º–∏—Å—Å–∏—è –ø–æ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–µ –ò–°–ú–ü":
            msg = (
                "–ü—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—å:\n"
                "‚Ä¢ –ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å –≥–ª–∞–≤–Ω–æ–≥–æ –≤—Ä–∞—á–∞ –ø–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π —á–∞—Å—Ç–∏ - –ú–∞–ª—ã—à–∫–∏–Ω–∞ –û–ª—å–≥–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞;\n\n"
                "–°–µ–∫—Ä–µ—Ç–∞—Ä—å:\n"
                "‚Ä¢ –í—Ä–∞—á-—ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥ ‚Äì –ß–∏–≥–∏—Ä–∏–Ω–æ–≤ –ò–≤–∞–Ω –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á;\n\n"
                "–ß–ª–µ–Ω—ã –∫–æ–º–∏—Å—Å–∏–∏:\n"
                "‚Ä¢ –ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å –≥–ª–∞–≤–Ω–æ–≥–æ –≤—Ä–∞—á–∞ –ø–æ –∫–ª–∏–Ω–∏–∫–æ-—ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ ‚Äì –ú–æ—Å–∫–∞–ª–µ–≤–∞ –ú–∞—Ä–∏–Ω–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞;\n"
                "‚Ä¢ –ó–∞–≤–µ–¥—É—é—â–∏–π –æ—Ç–¥–µ–ª–µ–Ω–∏–µ–º –∞–Ω–µ—Å—Ç–µ–∑–∏–æ–ª–æ–≥–∏–∏ –∏ —Ä–µ–∞–Ω–∏–º–∞—Ü–∏–∏ —Å –ø–∞–ª–∞—Ç–æ–π –†–ò–¢- –≤—Ä–∞—á-–∞–Ω–µ—Å—Ç–µ–∑–∏–æ–ª–æ–≥-—Ä–µ–∞–Ω–∏–º–∞—Ç–æ–ª–æ–≥ ‚Äì –¢–µ–π–º—É—Ä–æ–≤ –¢–∏–º—É—Ä –Æ—Å—ã—Ñ–æ–≤–∏—á;\n"
                "‚Ä¢ –ó–∞–≤–µ–¥—É—é—â–∏–π —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–º –æ—Ç–¥–µ–ª–µ–Ω–∏–µ–º-–≤—Ä–∞—á-—Ö–∏—Ä—É—Ä–≥ ‚Äì –ë—É–ª–∞—Ç–æ–≤ –ê–ª–µ–∫—Å–µ–π –Æ—Ä—å–µ–≤–∏—á;\n"
                "‚Ä¢ –ó–∞–≤–µ–¥—É—é—â–∏–π –æ—Ç–¥–µ–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–∞-–≤—Ä–∞—á-–∫–∞—Ä–¥–∏–æ–ª–æ–≥ ‚Äì –•–æ–º—è—á–µ–Ω–∫–æ –û–ª—å–≥–∞ –ò–≤–∞–Ω–æ–≤–Ω–∞;\n"
                "‚Ä¢ –ó–∞–≤–µ–¥—É—é—â–∏–π –∞–º–±—É–ª–∞—Ç–æ—Ä–Ω–æ-–ø–æ–ª–∏–∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º –æ—Ç–¥–µ–ª–µ–Ω–∏–µ–º-–≤—Ä–∞—á-—Ç–µ—Ä–∞–ø–µ–≤—Ç ‚Äì –û—Ä–∞–∑–º–∞–≥–æ–º–µ–¥–æ–≤–∞ –≠–ª—å–≤–∏—Ä–∞ –í—è—á–µ—Å–ª–∞–≤–æ–≤–Ω–∞;\n"
                "‚Ä¢ –ó–∞–≤–µ–¥—É—é—â–∏–π –∫–ª–∏–Ω–∏–∫–æ-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–µ–π ‚Äì –ú–µ—Ä–∫–æ –ú–∞–∫—Å–∏–º –ú–∏—Ö–∞–π–ª–æ–≤–∏—á;\n"
                "‚Ä¢ –ó–∞–≤–µ–¥—É—é—â–∏–π —ç–Ω–¥–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–∏–º –æ—Ç–¥–µ–ª–µ–Ω–∏–µ–º-–≤—Ä–∞—á-—ç–Ω–¥–æ—Å–∫–æ–ø–∏—Å—Ç ‚Äì –°–∏–≥–∞–µ–≤–∞ –Æ–ª–∏—è –°–µ—Ä–≥–µ–µ–≤–Ω–∞;\n"
                "‚Ä¢ –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–π —Ñ–∞—Ä–º–∞–∫–æ–ª–æ–≥ ‚Äì –ë–æ—Ä–∏—Å–æ–≤ –ê–ª–µ–∫—Å–µ–π –ú–∏—Ö–∞–π–ª–æ–≤–∏—á;\n"
                "‚Ä¢ –ó–∞–≤–µ–¥—É—é—â–∏–π –∞–ø—Ç–µ–∫–æ–π - –†–µ–º–ø–µ–Ω–∏–Ω–≥ –ê–Ω–∞—Å—Ç–∞—Å–∏—è –ê–Ω–¥—Ä–µ–µ–≤–Ω–∞;\n"
                "‚Ä¢ –ì–ª–∞–≤–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Å–µ—Å—Ç—Ä–∞ ‚Äì –ö–æ—á–µ—Ä–≥–∏–Ω–∞ –õ–∏–ª–∏—è –ê–ª–µ–∫—Å–µ–µ–≤–Ω–∞;"
            )
            mk = ReplyKeyboardMarkup(build_menu(ISM_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)

        elif text == "–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ò–°–ú–ü":
            stack.append("criteria")
            mk = ReplyKeyboardMarkup(build_menu(CRITERIA_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:", reply_markup=mk)

        elif text == "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –ò–°–ú–ü —É –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞":
            msg = (
                "1. –°–æ–±–ª—é–¥–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Ä –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏ \n"
                "‚Ä¢ –ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫ ‚Äì –°–û–ü-044-–†–ù-–°–¢; –°–û–ü-045-–†–ù-–°–¢;\n"
                "‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã (–°–ò–ó) ‚Äì –°–û–ü-13-23-–†–ù-–°–¢;\n"
                "‚Ä¢ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ —Å –∏–Ω—ä–µ–∫—Ü–∏–æ–Ω–Ω—ã–º–∏ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞–º–∏- –ò-058-–†–ù-–°–¢;\n"
                "‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è ‚Äì –ò-025-–†–ù-–°–¢;\n"
                "2. –°—Ç–µ—Ä–∏–ª–∏–∑–∞—Ü–∏—è –∏ –¥–µ–∑–∏–Ω—Ñ–µ–∫—Ü–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏–∑–¥–µ–ª–∏–π- –ò-018-–†–ù-–°–¢; –ò-–†–ù-–°–¢-2023-11-1;\n"
                "3. –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–π –ø—Ä–∏ –∏–Ω–≤–∞–∑–∏–≤–Ω—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä–∞—Ö ‚Äì –°–û–ü-6,7,8,9,10,11,12-–†–ù-–°–¢;\n"
                "4. –ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ–ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –∏ —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ–≤- –ò-065-–†–ù-–°–¢; –ò-060-–†–ù-–°–¢;\n"
                "5. –ò–∑–æ–ª—è—Ü–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ ‚Äì –°–û–ü-14-23-–†–ù-–°–¢;\n"
                "6. –í–∞–∫—Ü–∏–Ω–∞—Ü–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ ‚Äì –ò-039\n"
                "‚Ä¢ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –≤–∞–∫—Ü–∏–Ω–∞—Ü–∏—è –ø—Ä–æ—Ç–∏–≤:\n"
                "‚Ä¢ –ì–µ–ø–∞—Ç–∏—Ç–∞ B (–ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–≤–µ–¥–µ–Ω–∏–π –æ –≤–∞–∫—Ü–∏–Ω–∞—Ü–∏–∏/—Å–≤–µ–¥–µ–Ω–∏–π –æ –Ω–∞–ª–∏—á–∏–∏ –∞–Ω—Ç–∏—Ç–µ–ª)\n"
                "‚Ä¢ –ö–æ—Ä—å, –∫—Ä–∞—Å–Ω—É—Ö–∞, –ø–∞—Ä–æ—Ç–∏—Ç (–ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–≤–µ–¥–µ–Ω–∏–π –æ –≤–∞–∫—Ü–∏–Ω–∞—Ü–∏–∏/—Å–≤–µ–¥–µ–Ω–∏–π –æ –Ω–∞–ª–∏—á–∏–∏ –∞–Ω—Ç–∏—Ç–µ–ª)\n"
                "‚Ä¢ –ì—Ä–∏–ø–ø (–µ–∂–µ–≥–æ–¥–Ω–æ)\n"
                "‚Ä¢ –î–∏—Ñ—Ç–µ—Ä–∏—è, —Å—Ç–æ–ª–±–Ω—è–∫, –∫–æ–∫–ª—é—à (1 —Ä–∞–∑ –≤ 10 –ª–µ—Ç)\n"
                "7. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ä—ã ‚Äì –ò-022-–†–ù-–°–¢"
            )
            mk = ReplyKeyboardMarkup(build_menu(ISM_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)

        elif text == "–ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã":
            msg = (
                "–ü–µ—Ä–µ—á–µ–Ω—å –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä:\n"
                "‚Ä¢ –ò–ê–ò - –∏–º–ø–ª–∞–Ω—Ç–∞—Ç-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è \n"
                "‚Ä¢ –ò–í–õ ‚Äì –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –≤–µ–Ω—Ç–∏–ª—è—Ü–∏—è –ª–µ–≥–∫–∏—Ö \n"
                "‚Ä¢ –ò–ú–ü - –∏–Ω—Ñ–µ–∫—Ü–∏—è –º–æ—á–µ–≤—ã–≤–æ–¥—è—â–∏—Ö –ø—É—Ç–µ–π \n"
                "‚Ä¢ –ò–î–ü - –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π\n"
                "‚Ä¢ –ò–°–ú–ü - –∏–Ω—Ñ–µ–∫—Ü–∏—è (–∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–∞—è –±–æ–ª–µ–∑–Ω—å), —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏\n"
                "‚Ä¢ –ò–û–•–í - –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ \n"
                "‚Ä¢ –ö–ê–ò–ö - –∫–∞—Ç–µ—Ç–µ—Ä-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞ \n"
                "‚Ä¢ –ü–ê–ò - –ø–µ—Ä–µ–ª–æ–º-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è \n"
                "‚Ä¢ –ü–ü–ò - –ø–µ—Ä–∏–ø—Ä–æ—Ç–µ–∑–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è \n"
                "‚Ä¢ –ü–í–ö- –ø–µ—Ä–∏—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–π –≤–µ–Ω–æ–∑–Ω—ã–π –∫–∞—Ç–µ—Ç–µ—Ä \n"
                "‚Ä¢ –°–û–° ‚Äì —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ª—É—á–∞—è \n"
                "‚Ä¢ –¶–í–ö ‚Äì —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –≤–µ–Ω–æ–∑–Ω—ã–π –∫–∞—Ç–µ—Ç–µ—Ä"
            )
            mk = ReplyKeyboardMarkup(build_menu(ISM_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)

        elif text == "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª—É—á–∞–µ–≤ –ò–°–ú–ü":
            stack.append("sos")
            mk = ReplyKeyboardMarkup(build_menu(SOS_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ñ–µ–∫—Ü–∏–∏:", reply_markup=mk)

        elif text == "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –ò–°–ú–ü":
            await update.message.reply_text(f"üìÑ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –ò–°–ú–ü:\n{PROGRAM_LINK}")
            mk = ReplyKeyboardMarkup(build_menu(ISM_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –≤ –ò–°–ú–ü:", reply_markup=mk)

        elif text == "–í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ò–°–ú–ü":
            stack.append("detected")
            mk = ReplyKeyboardMarkup(build_menu(DETECTED_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:", reply_markup=mk)

        else:
            mk = ReplyKeyboardMarkup(build_menu(ISM_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—É–Ω–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.", reply_markup=mk)
        return

    # === –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ò–°–ú–ü ===
    if stack[-1] == "criteria":
        if text == "–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤":
            msg = (
                "1. –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–µ–º–æ–µ, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å —É—á–µ—Ç–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π; \n"
                "2. –≤–æ–∑–Ω–∏–∫–ª–æ —É —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç—Ä—É–¥–æ–≤—ã—Ö –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏; \n"
                "3. —Å–≤—è–∑–∞–Ω–æ —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏; \n"
                "4. –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ —É —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ –ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –Ω–∞ —Ä–∞–±–æ—Ç—É –≤ –¥–∞–Ω–Ω—É—é –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é, –≤ —Ç–æ–º —á–∏—Å–ª–µ –≤ –∏–Ω–∫—É–±–∞—Ü–∏–æ–Ω–Ω–æ–º –ø–µ—Ä–∏–æ–¥–µ; \n"
                "5. –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±–æ—Å—Ç—Ä–µ–Ω–∏–µ–º —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –∏–º–µ–≤—à–µ–≥–æ—Å—è —É —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ –¥–æ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã."
            )
            mk = ReplyKeyboardMarkup(build_menu(CRITERIA_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        elif text == "–£ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤":
            msg = (
                "1. –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–µ–º–æ–µ, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å —É—á–µ—Ç–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π; \n"
                "2. –≤–æ–∑–Ω–∏–∫–ª–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–∞ –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –∑–∞ –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏ –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–∏–º–ø—Ç–æ–º–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π; \n"
                "3. –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–≤—è–∑—å –∏—Ö –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏ (–ª–µ—á–µ–Ω–∏–µ–º, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è–º–∏, –∏–º–º—É–Ω–∏–∑–∞—Ü–∏–µ–π –∏ –ø—Ä.);\n"
                "4. –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–æ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –≥–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∑–∞ –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏ –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é, –≤ —Ç–æ–º —á–∏—Å–ª–µ –≤ –∏–Ω–∫—É–±–∞—Ü–∏–æ–Ω–Ω–æ–º –ø–µ—Ä–∏–æ–¥–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –∫—Ä–æ–º–µ —Å–ª—É—á–∞–µ–≤ –∏–Ω—Ñ–µ–∫—Ü–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–µ–π –≥–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏–ª–∏ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏–º –æ–±—Ä–∞—â–µ–Ω–∏–µ–º –∑–∞ –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏ –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é; \n"
                "5. –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–º –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º –ø–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∏–º–µ–≤—à–µ–≥–æ—Å—è —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –≥–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∑–∞ –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏; \n"
                "6. –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±–æ—Å—Ç—Ä–µ–Ω–∏–µ–º —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –∏–º–µ–≤—à–µ–≥–æ—Å—è —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –≥–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∑–∞ –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏;"
            )
            mk = ReplyKeyboardMarkup(build_menu(CRITERIA_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(CRITERIA_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:", reply_markup=mk)
        return

    # === –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ò–°–ú–ü ===
    if stack[-1] == "detected":
        if text == "–°—Ç–∞—Ü–∏–æ–Ω–∞—Ä + –•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ":
            msg = (
                "–í –ø–µ—Ä–∏–æ–¥ —Å 01.12.2025 –ø–æ 01.11.2025  –≤ –æ—Ç–¥–µ–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–∞ + —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–º –æ—Ç–¥–µ–ª–µ–Ω–∏–∏ –±—ã–ª –≤—ã—è–≤–ª–µ–Ω 61 –ø–∞—Ü–∏–µ–Ω—Ç —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è. –ò–∑ –Ω–∏—Ö ‚Äì –∫ –∫—Ä–∏—Ç–µ—Ä–∏—è–º –ò–°–ú–ü –ø–æ–¥—Ö–æ–¥–∏–ª–æ ‚Äì 12 –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ (–∏–∑ –Ω–∏—Ö 12 ‚Äì ¬´–ó–ê–ù–û–°–´¬ª)\n"
                f"–û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏ —ç–ø–∏–¥—Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –º–æ–∂–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ:\n{PROTOCOLS_LINK}"
            )
            mk = ReplyKeyboardMarkup(build_menu(DETECTED_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        elif text == "–û–ê–†–ò–¢":
            msg = (
                "–í –ø–µ—Ä–∏–æ–¥ —Å 01.12.2025 –ø–æ 01.11.2025  –≤ –û–ê–†–ò–¢ –±—ã–ª–æ –≤—ã—è–≤–ª–µ–Ω 26 –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è. –ò–∑ –Ω–∏—Ö ‚Äì –∫ –∫—Ä–∏—Ç–µ—Ä–∏—è–º –ò–°–ú–ü –ø–æ–¥—Ö–æ–¥–∏–ª–æ ‚Äì 6 –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ (–∏–∑ –Ω–∏—Ö 5 ‚Äì ¬´–ó–ê–ù–û–°–´¬ª; 1 ‚Äì ¬´–°–û–ë–°–¢–í–ï–ù–ù–û–ï¬ª\n"
                f"–û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏ —ç–ø–∏–¥—Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –º–æ–∂–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ:\n{PROTOCOLS_LINK}"
            )
            mk = ReplyKeyboardMarkup(build_menu(DETECTED_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        elif text == "–û–±–æ–±—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ":
            await update.message.reply_photo(photo=CHART_IMAGE_URL)
            mk = ReplyKeyboardMarkup(build_menu(DETECTED_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:", reply_markup=mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(DETECTED_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:", reply_markup=mk)
        return

    # === –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª—É—á–∞–µ–≤ –ò–°–ú–ü ===
    if stack[-1] == "sos":
        sos_map = {
            "–ò–ê–ò - –∏–º–ø–ª–∞–Ω—Ç–∞—Ç-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è": ("–ò–ê–ò:", IAI_MENU, "iai"),
            "–ò–î–ü ‚Äì –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π": ("–ò–î–ü:", IDD_MENU, "idd"),
            "–ò–ú–ü - –∏–Ω—Ñ–µ–∫—Ü–∏—è –º–æ—á–µ–≤—ã–≤–æ–¥—è—â–∏—Ö –ø—É—Ç–µ–π": ("–ò–ú–ü:", IMP_MENU, "imp"),
            "–ò–û–•–í - –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞": ("–ò–û–•–í:", IOHV_MENU, "iohv"),
            "–ò–ö - –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –∫—Ä–æ–≤–æ—Ç–æ–∫–∞": ("–ò–Ω—Ñ–µ–∫—Ü–∏–∏ –∫—Ä–æ–≤–æ—Ç–æ–∫–∞:", IK_MENU, "ik"),
        }
        if text in sos_map:
            msg, menu_btns, next_state = sos_map[text]
            stack.append(next_state)
            mk = ReplyKeyboardMarkup(build_menu(menu_btns), resize_keyboard=True)
            await update.message.reply_text(msg, reply_markup=mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(SOS_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ñ–µ–∫—Ü–∏–∏:", reply_markup=mk)
        return

    # === –ò–ê–ò ===
    if stack[-1] == "iai":
        iai_texts = {
            "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ò–ê–ò": (
                "–ò–º–ø–ª–∞–Ω—Ç–∞—Ç-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è- –æ—Å—Ç—Ä–∞—è –∏–ª–∏ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞, —Ä–∞–∑–≤–∏–≤—à–∞—è—Å—è –ø–æ—Å–ª–µ –∏–º–ø–ª–∞–Ω—Ç–∞—Ü–∏–∏.\n"
                "–ü–µ—Ä–∏–ø—Ä–æ—Ç–µ–∑–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è- –æ—Å—Ç—Ä–∞—è –∏–ª–∏ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞, —Ä–∞–∑–≤–∏–≤—à–∞—è—Å—è –ø–æ—Å–ª–µ –∏–º–ø–ª–∞–Ω—Ç–∞—Ü–∏–∏ —ç–Ω–¥–æ–ø—Ä–æ—Ç–µ–∑–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π –∏–º–ø–ª–∞–Ω—Ç–∞—Ç–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–µ–∫—Ü–∏–∏.\n"
                "–ü–µ—Ä–µ–ª–æ–º-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è- –æ—Å—Ç—Ä—ã–π –∏–ª–∏ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–π –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≤ –æ–±–ª–∞—Å—Ç–∏ –ø–µ—Ä–µ–ª–æ–º–∞ –∫–æ—Å—Ç–µ–π, —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ—Å—Ç–µ–æ—Å–∏–Ω—Ç–µ–∑–∏—Ä—É—é—â–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–ø–ª–∞—Å—Ç–∏–Ω–∞, —Å—Ç–µ—Ä–∂–µ–Ω—å, –∞–ø–ø–∞—Ä–∞—Ç –≤–Ω–µ—à–Ω–µ–π —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∏ —Ç.–¥.) –∏ –æ–∫—Ä—É–∂–∞—é—â–∏—Ö —Ç–∫–∞–Ω–µ–π"
            ),
            "–ü—Ä–∏–∑–Ω–∞–∫–∏ –ò–ê–ò": (
                "1) –ü–∞—Ü–∏–µ–Ω—Ç –∏–º–µ–µ—Ç, –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:\n"
                "ÔÉº —Å–≤–∏—â–µ–≤–æ–π —Ö–æ–¥, –∏–¥—É—â–∏–π –≤ –ø–æ–ª–æ—Å—Ç—å —Å—É—Å—Ç–∞–≤–∞;\n"
                "ÔÉº –≥–Ω–æ–π–Ω–æ–µ –æ—Ç–¥–µ–ª—è–µ–º–æ–µ –∏–∑ –¥—Ä–µ–Ω–∞–∂–∞, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –≤ –ø–æ–ª–æ—Å—Ç—å –ø—Ä–æ—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å—É—Å—Ç–∞–≤–∞;\n"
                "ÔÉº –≤—ã–¥–µ–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ –∏–∑ –∂–∏–¥–∫–æ—Å—Ç–∏ –∏–ª–∏ —Ç–∫–∞–Ω–∏, –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –∞—Å–µ–ø—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–æ—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å—É—Å—Ç–∞–≤–∞ –ª—é–±—ã–º –º–µ—Ç–æ–¥–æ–º;\n"
                "ÔÉº –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –ø–µ—Ä–∏–ø—Ä–æ—Ç–µ–∑–Ω–æ–π –∏–Ω—Ñ–µ–∫—Ü–∏–∏ (–ü–ü–ò) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–µ–π–∫–æ—Ü–∏—Ç–æ–≤ > 3000/–º–∫–ª –∏/–∏–ª–∏ –¥–æ–ª—è –Ω–µ–π—Ç—Ä–æ—Ñ–∏–ª—å–Ω—ã—Ö –≥—Ä–∞–Ω—É–ª–æ—Ü–∏—Ç–æ–≤ > 70% –≤ —Å—É—Å—Ç–∞–≤–Ω–æ–º –∞—Å–ø–∏—Ä–∞—Ç–µ –ø—Ä–∏ —Ü–∏—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏.\n"
                "2) –ò\n"
                "–ø—Ä–∏ –æ—Å–º–æ—Ç—Ä–µ, –≤–æ –≤—Ä–µ–º—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏, –ø—Ä–∏ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º, –≥–∏—Å—Ç–æ–ø–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –∏–ª–∏ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ (—Ñ–∏—Å—Ç—É–ª–æ–≥—Ä–∞—Ñ–∏–∏) –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–Ω—Ñ–µ–∫—Ü–∏–∏, –≤–æ–≤–ª–µ–∫–∞—é—â–µ–π –æ–±–ª–∞—Å—Ç—å –ø—Ä–æ—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å—É—Å—Ç–∞–≤–∞ –∏–ª–∏ –≤–æ–≤–ª–µ–∫–∞—é—â–µ–π –æ–±–ª–∞—Å—Ç—å –ø–µ—Ä–µ–ª–æ–º–∞ –∏/–∏–ª–∏ –æ—Å—Ç–µ–æ—Å–∏–Ω—Ç–µ–∑–∞"
            ),
            "–§–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞ —Ä–∞–∑–≤–∏—Ç–∏—è –ü–ü–ò": (
                "‚Ä¢ –°–∞—Ö–∞—Ä–Ω—ã–π –¥–∏–∞–±–µ—Ç\n"
                "‚Ä¢ –û–∂–∏—Ä–µ–Ω–∏–µ –∏–ª–∏ –∏—Å—Ç–æ—â–µ–Ω–∏–µ\n"
                "‚Ä¢ –¶–∏—Ä—Ä–æ–∑ –ø–µ—á–µ–Ω–∏\n"
                "‚Ä¢ –ê–ª–∫–æ–≥–æ–ª–∏–∑–º\n"
                "‚Ä¢ –ù–∞—Ä–∫–æ–º–∞–Ω–∏—è\n"
                "‚Ä¢ –•—Ä–æ–Ω–∏—á–µ—Å–∫–∞—è –ø–æ—á–µ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å (–•–ü–ù)\n"
                "‚Ä¢ –ò–º–º—É–Ω–æ—Å—É–ø—Ä–µ—Å—Å–∏—è (—Ç–µ—Ä–∞–ø–∏—è –≥–ª—é–∫–æ–∫–æ—Ä—Ç–∏–∫–æ–∏–¥–∞–º–∏, —Ü–∏—Ç–æ—Å—Ç–∞—Ç–∏–∫–∞–º–∏, –í–ò–ß)\n"
                "‚Ä¢ –°–ø–ª–µ–Ω—ç–∫—Ç–æ–º–∏—è\n"
                "‚Ä¢ –†–µ–≤–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è\n"
                "‚Ä¢ –ü—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–∏–Ω–≤–∞–∑–∏–≤–Ω—ã–µ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏) –≤ –æ–±–ª–∞—Å—Ç–∏ —Å—É—Å—Ç–∞–≤–∞\n"
                "‚Ä¢ –ù–∞–ª–∏—á–∏–µ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –æ—á–∞–≥–æ–≤ –∏–Ω—Ñ–µ–∫—Ü–∏–∏"
            ),
            "–¢–∏–ø—ã –ü–ü–ò": (
                "I - –û—Å—Ç—Ä–∞—è –ø–æ—Å–ª–µ–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è (–º–µ–Ω–µ–µ 4 –Ω–µ–¥–µ–ª—å)\n"
                "II  - –ü–æ–∑–¥–Ω—è—è —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∞—è (–æ—Ç 4 –Ω–µ–¥–µ–ª—å –¥–æ –æ–¥–Ω–æ–≥–æ –≥–æ–¥–∞)\n"
                "III - –û—Å—Ç—Ä–∞—è –≥–µ–º–∞—Ç–æ–≥–µ–Ω–Ω–∞—è/–æ—Ç—Å—Ä–æ—á–µ–Ω–Ω–∞—è (—á–µ—Ä–µ–∑ –≥–æ–¥ –∏ –±–æ–ª–µ–µ)\n"
                "IV - –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ç—Ä–∞–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –∫—É–ª—å—Ç—É—Ä–∞ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Å–µ–≤—ã –≤ 2‚Äì5 –∏–Ω—Ç—Ä–∞–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ–±—Ä–∞–∑—Ü–∞—Ö —Ç–∫–∞–Ω–µ–π)"
            ),
            "–í–µ—Ä–æ—è—Ç–Ω—ã–µ –ø—É—Ç–∏ –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏—è –ü–ü–ò": (
                "I –∏ II ‚Äì –ü–µ—Ä–∏–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—É—Ç—å (–≤–æ–∑–±—É–¥–∏—Ç–µ–ª–∏ - S. –êureus; Streptococcus sp.; Enterococcus sp.; –ö–æ–∞–≥—É–ª–∞–∑–æ–Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç–∞—Ñ–∏–ª–æ–∫–æ–∫–∫–∏)\n"
                "III ‚Äì –ì–µ–º–∞—Ç–æ–≥–µ–Ω–Ω—ã–π –ø—É—Ç—å (–≤–æ–∑–±—É–¥–∏—Ç–µ–ª–∏ - S. –êureus; Streptococcus sp.; P. Acnes; E. –°oli)\n"
                "IV -  –ì–µ–º–∞—Ç–æ–≥–µ–Ω–Ω—ã–π –∏ –ø–µ—Ä–∏–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—É—Ç—å (–≤–æ–∑–±—É–¥–∏—Ç–µ–ª–∏ - –ö–æ–∞–≥—É–ª–∞–∑–æ–Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç–∞—Ñ–∏–ª–æ–∫–æ–∫–∫–∏)"
            ),
            "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –ò–ê–ò": (
                "1) –õ–µ—á–∞—â–∏–π –≤—Ä–∞—á –∏–Ω—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è —Å–≤–æ–µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏ –≤—Ä–∞—á–∞-—ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∞ –æ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –∏–Ω—Ñ–µ–∫—Ü–∏—é –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –ø–∏—Å—å–º–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–∏—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤:\n"
                "‚Ä¢ –§.–ò.–û. –ø–∞—Ü–∏–µ–Ω—Ç–∞, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è, –Ω–æ–º–µ—Ä –≠–ú–ö;\n"
                "‚Ä¢ –¥–∞—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–∏–º–ø—Ç–æ–º–æ–≤, —É–∫–∞–∑—ã–≤–∞—é—â–∏—Ö –Ω–∞ –ò–û–•–í;\n"
                "‚Ä¢ –≤–æ–∑–Ω–∏–∫—à–∏–µ —Å–∏–º–ø—Ç–æ–º—ã.\n"
                "2) –≤–∑—è—Ç—å –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–∑ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ (–¥–æ –Ω–∞—á–∞–ª–∞ –ø—Ä–∏–µ–º–∞ –∞–Ω—Ç–∏–º–∏–∫—Ä–æ–±–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤), —Å —Ü–µ–ª—å—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ –æ–ø—Ä–æ–≤–µ—Ä–∂–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ–∑–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ —ç—Ç–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –≤–æ–∑–±—É–¥–∏—Ç–µ–ª—è (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è;\n"
                "3) –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä, —Å–æ–≥–ª–∞—Å–Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏;\n"
                "4) –≤—ã—è–≤–∏—Ç—å –∫—Ä—É–≥ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –ª–∏—Ü (—Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Ä–∞—á—É —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥—É) –∏–∑ —á–∏—Å–ª–∞ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞;\n"
                "5) –ø—Ä–æ–≤–µ—Å—Ç–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö —Å –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è–º–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏);"
            ),
        }
        if text in iai_texts:
            mk = ReplyKeyboardMarkup(build_menu(IAI_MENU), resize_keyboard=True)
            await reply_safe(update, iai_texts[text], mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(IAI_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –ò–ê–ò:", reply_markup=mk)
        return

    # === –ò–î–ü ===
    if stack[-1] == "idd":
        if text == "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ò–û–î":
            stack.append("idd_def")
            mk = ReplyKeyboardMarkup(build_menu(IDD_DEF_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø:", reply_markup=mk)
        elif text == "–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ò–û–î":
            stack.append("idd_crit")
            mk = ReplyKeyboardMarkup(build_menu(IDD_CRIT_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–Ω–µ–≤–º–æ–Ω–∏–∏:", reply_markup=mk)
        elif text == "–î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –ò–û–î":
            msg = (
                "–õ–µ—á–∞—â–∏–π –≤—Ä–∞—á –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –ò–û–î –¥–æ–ª–∂–µ–Ω:\n"
                "1) –Ω–µ–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ª–∞—Ç—É (–ø–∞–ª–∞—Ç—É-–∏–∑–æ–ª—è—Ç–æ—Ä);\n"
                "2) –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è —Å–≤–æ–µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏ –≤—Ä–∞—á–∞-—ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∞ –æ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –∏–Ω—Ñ–µ–∫—Ü–∏—é —É—Å—Ç–Ω–æ (–ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É) –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –ø–∏—Å—å–º–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–∏—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤:\n"
                "‚Ä¢ –§.–ò.–û. –ø–∞—Ü–∏–µ–Ω—Ç–∞, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è, –Ω–æ–º–µ—Ä –≠–ú–ö;\n"
                "‚Ä¢ –¥–∞—Ç–∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–Ω–≤–∞–∑–∏–≤–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞;\n"
                "‚Ä¢ –¥–∞—Ç–∞ —Å–º–µ–Ω—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞/–∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏—Ö, –µ–≥–æ –ø—Ä–æ–º—ã–≤–∫–∏;\n"
                "‚Ä¢ –¥–∞—Ç–∞ —Å–∞–Ω–∞—Ü–∏–∏;\n"
                "‚Ä¢ –¥–∞—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–∏–º–ø—Ç–æ–º–æ–≤, —É–∫–∞–∑—ã–≤–∞—é—â–∏—Ö –Ω–∞ –ò–û–î;\n"
                "‚Ä¢ –≤–æ–∑–Ω–∏–∫—à–∏–µ —Å–∏–º–ø—Ç–æ–º—ã;\n"
                "‚Ä¢ –ø—Ä–∏–ª–æ–∂–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é.\n\n"
                "3) –≤–∑—è—Ç—å –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–∑ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ (–¥–æ –Ω–∞—á–∞–ª–∞ –ø—Ä–∏–µ–º–∞ –∞–Ω—Ç–∏–º–∏–∫—Ä–æ–±–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤), —Å —Ü–µ–ª—å—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ –æ–ø—Ä–æ–≤–µ—Ä–∂–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ–∑–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ —ç—Ç–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –≤–æ–∑–±—É–¥–∏—Ç–µ–ª—è (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è;\n"
                "4) –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä, —Å–æ–≥–ª–∞—Å–Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏;\n"
                "5) –≤—ã—è–≤–∏—Ç—å –∫—Ä—É–≥ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –ª–∏—Ü (—Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Ä–∞—á—É —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥—É) –∏–∑ —á–∏—Å–ª–∞ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞;\n"
                "6) –ø—Ä–æ–≤–µ—Å—Ç–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö —Å –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è–º–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏);"
            )
            mk = ReplyKeyboardMarkup(build_menu(IDD_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(IDD_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:", reply_markup=mk)
        return

    if stack[-1] == "idd_def":
        def_map = {
            "–ü–Ω–µ–≤–º–æ–Ω–∏—è, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏": (
                "–ü–Ω–µ–≤–º–æ–Ω–∏—è, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏ - –ø–Ω–µ–≤–º–æ–Ω–∏—è, —Ä–∞–∑–≤–∏–≤—à–∞—è—Å—è —á–µ—Ä–µ–∑ 48 —á –∏ –±–æ–ª–µ–µ –ø–æ—Å–ª–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –∑–∞ –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏, –≤ —Ç.—á. –≥–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä (–≤–Ω—É—Ç—Ä–∏–±–æ–ª—å–Ω–∏—á–Ω–∞—è –ø–Ω–µ–≤–º–æ–Ω–∏—è). –î–µ–ª—è—Ç—Å—è –Ω–∞ :\n"
                "1) –ø–Ω–µ–≤–º–æ–Ω–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏, –±–µ–∑ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è; \n"
                "2) –ø–Ω–µ–≤–º–æ–Ω–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏, –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ. \n"
                "3) —Ç–∞–∫–∂–µ –≤—ã–¥–µ–ª—è—é—Ç –ø–Ω–µ–≤–º–æ–Ω–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–π –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–µ–π –ª–µ–≥–∫–∏—Ö (–ò–í–õ –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–Ω–µ–≤–º–æ–Ω–∏–∏), –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫–∂–µ –º–æ–≥—É—Ç –±—ã—Ç—å –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –∏–ª–∏ –±–µ–∑ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è."
            ),
            "–¢—Ä–∞—Ö–µ–æ–±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ (–±—Ä–æ–Ω—Ö–∏—Ç, —Ç—Ä–∞—Ö–µ–æ–±—Ä–æ–Ω—Ö–∏—Ç, –±—Ä–æ–Ω—Ö–∏–æ–ª–∏—Ç, —Ç—Ä–∞—Ö–µ–∏—Ç –±–µ–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–Ω–µ–≤–º–æ–Ω–∏–∏)": (
                "–¢—Ä–∞—Ö–µ–æ–±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ (–±—Ä–æ–Ω—Ö–∏—Ç, —Ç—Ä–∞—Ö–µ–æ–±—Ä–æ–Ω—Ö–∏—Ç, –±—Ä–æ–Ω—Ö–∏–æ–ª–∏—Ç, —Ç—Ä–∞—Ö–µ–∏—Ç –±–µ–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–Ω–µ–≤–º–æ–Ω–∏–∏) - —ç—Ç–æ –≤–æ—Å–ø–∞–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤ —Ç—Ä–∞—Ö–µ–µ –∏ –±—Ä–æ–Ω—Ö–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—â–µ –≤—Å–µ–≥–æ —Ä–∞–∑–≤–∏–≤–∞—é—Ç—Å—è –ø–æ –ø—Ä–∏—á–∏–Ω–µ –≤—Ç–æ—Ä–∂–µ–Ω–∏—è –≤–∏—Ä—É—Å–Ω–æ–π –∏–ª–∏ –±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–µ–∫—Ü–∏–∏.\n"
                "–¢—Ä–∞—Ö–µ–æ–±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å –•–û–¢–Ø –ë–´ –û–î–ù–û–ú–£ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤:\n"
                "–ö—Ä–∏—Ç–µ—Ä–∏–π 1: \n"
                "ÔÉò –£ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –ù–ï –∏–º–µ–µ—Ç—Å—è –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö –∏–ª–∏ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–Ω–µ–≤–º–æ–Ω–∏–∏\n"
                "–ò \n"
                "ÔÉò –£ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–º–µ—é—Ç—Å—è –ü–û –ö–†–ê–ô–ù–ï–ô –ú–ï–†–ï –î–í–ê –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–ª–∏ —Å–∏–º–ø—Ç–æ–º–æ–≤ –±–µ–∑ –¥—Ä—É–≥–æ–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –ø—Ä–∏—á–∏–Ω—ã: –ª–∏—Ö–æ—Ä–∞–¥–∫–∞ (> 37,5ÔÇ∞ –°), –∫–∞—à–µ–ª—å, –≤–Ω–æ–≤—å –ø–æ—è–≤–∏–≤—à–∞—è—Å—è –≥–Ω–æ–π–Ω–∞—è –º–æ–∫—Ä–æ—Ç–∞ –∏–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –µ–µ –ø—Ä–æ–¥—É–∫—Ü–∏–∏, —Ö—Ä–∏–ø—ã, —Ç—è–∂–µ–ª–æ–µ –¥—ã—Ö–∞–Ω–∏–µ \n"
                "–ò \n"
                "ÔÉò —Ö–æ—Ç—è –±—ã –û–î–ù–û –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤:\n"
                "1. –í—ã–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∑–±—É–¥–∏—Ç–µ–ª—è –∏–∑ –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞, –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –ø—É—Ç–µ–º –≥–ª—É–±–æ–∫–æ–π —Ç—Ä–∞—Ö–µ–∞–ª—å–Ω–æ–π –∞—Å–ø–∏—Ä–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–∏ –±—Ä–æ–Ω—Ö–æ—Å–∫–æ–ø–∏–∏ \n"
                "2. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω—Ç–∏–≥–µ–Ω–∞ –≤ —Å–µ–∫—Ä–µ—Ç–∞—Ö –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π \n"
                "–ö—Ä–∏—Ç–µ—Ä–∏–π 2: \n"
                "ÔÉò –£ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–º–µ—é—Ç—Å—è –ü–û –ö–†–ê–ô–ù–ï–ô –ú–ï–†–ï –î–í–ê –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–ª–∏ —Å–∏–º–ø—Ç–æ–º–æ–≤ –±–µ–∑ –¥—Ä—É–≥–æ–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –ø—Ä–∏—á–∏–Ω—ã: –ª–∏—Ö–æ—Ä–∞–¥–∫–∞ (> 37,5ÔÇ∞ –°), –∫–∞—à–µ–ª—å, –≤–Ω–æ–≤—å –ø–æ—è–≤–∏–≤—à–∞—è—Å—è –≥–Ω–æ–π–Ω–∞—è –º–æ–∫—Ä–æ—Ç–∞ –∏–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –µ–µ –ø—Ä–æ–¥—É–∫—Ü–∏–∏, —Ö—Ä–∏–ø—ã, —Ç—è–∂–µ–ª–æ–µ –¥—ã—Ö–∞–Ω–∏–µ, —Ä–µ—Å–ø–∏—Ä–∞—Ç–æ—Ä–Ω—ã–π –¥–∏—Å—Ç—Ä–µ—Å—Å, –∞–ø–Ω–æ—ç –∏–ª–∏ –±—Ä–∞–¥–∏–∫–∞—Ä–¥–∏—è \n"
                "–ò \n"
                "ÔÉò —Ö–æ—Ç—è –±—ã –û–î–ù–û –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤: \n"
                "1. –í—ã–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∑–±—É–¥–∏—Ç–µ–ª—è –∏–∑ –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞, –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –ø—É—Ç–µ–º –≥–ª—É–±–æ–∫–æ–π —Ç—Ä–∞—Ö–µ–∞–ª—å–Ω–æ–π –∞—Å–ø–∏—Ä–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–∏ –±—Ä–æ–Ω—Ö–æ—Å–∫–æ–ø–∏–∏ \n"
                "2. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω—Ç–∏–≥–µ–Ω–∞ –≤ —Å–µ–∫—Ä–µ—Ç–∞—Ö –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π \n"
                "–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–π —Ç–∏—Ç—Ä –∞–Ω—Ç–∏—Ç–µ–ª –∫–ª–∞—Å—Å–∞ IgM –∏–ª–∏ —á–µ—Ç—ã—Ä–µ—Ö–∫—Ä–∞—Ç–Ω–æ–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–µ –≤ –ø–∞—Ä–Ω—ã—Ö –æ–±—Ä–∞–∑—Ü–∞—Ö —Å—ã–≤–æ—Ä–æ—Ç–∫–∏ —É—Ä–æ–≤–Ω—è –∞–Ω—Ç–∏—Ç–µ–ª –∫–ª–∞—Å—Å–∞ IgG –∫ –≤–æ–∑–±—É–¥–∏—Ç–µ–ª—é"
            ),
            "–ü—Ä–æ—á–∏–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –Ω–∏–∂–Ω–∏—Ö –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π": (
                "–ü—Ä–æ—á–∏–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –Ω–∏–∂–Ω–∏—Ö –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π –¥–æ–ª–∂–Ω—ã —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å –•–û–¢–Ø –ë–´ –û–î–ù–û–ú–£ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤: \n"
                "–ö—Ä–∏—Ç–µ—Ä–∏–π 1: \n"
                "–í –º–∞–∑–∫–µ –∏–ª–∏ –∫—É–ª—å—Ç—É—Ä–µ –∏–∑ –ª–µ–≥–æ—á–Ω–æ–π —Ç–∫–∞–Ω–∏ –∏–ª–∏ –∂–∏–¥–∫–æ—Å—Ç–∏, –≤–∫–ª—é—á–∞—è –ø–ª–µ–≤—Ä–∞–ª—å–Ω—É—é –∂–∏–¥–∫–æ—Å—Ç—å, –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º—ã \n"
                "–ö—Ä–∏—Ç–µ—Ä–∏–π 2: \n"
                "–£ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–º–µ–µ—Ç—Å—è –∞–±—Å—Ü–µ—Å—Å –ª–µ–≥–∫–æ–≥–æ –∏–ª–∏ —ç–º–ø–∏–µ–º–∞, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –≤ —Ö–æ–¥–µ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–∏ –≥–∏—Å—Ç–æ–ø–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ \n"
                "–ö—Ä–∏—Ç–µ—Ä–∏–π 3: \n"
                "–£ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–º–µ—é—Ç—Å—è —Ä–µ–Ω—Ç–≥–µ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞–±—Å—Ü–µ—Å—Å–∞ –ª–µ–≥–∫–æ–≥–æ."
            )
        }
        mk = ReplyKeyboardMarkup(build_menu(IDD_DEF_MENU), resize_keyboard=True)
        await reply_safe(update, def_map.get(text, "–¢–µ–∫—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω."), mk)
        return

    if stack[-1] == "idd_crit":
        crit_map = {
            "–ø–Ω–µ–≤–º–æ–Ω–∏–∏ –±–µ–∑ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è": (
                "ÔÉº —Ä–∞–∑–≤–∏–ª–∞—Å—å —á–µ—Ä–µ–∑ 48 —á–∞—Å–æ–≤ –∏ –±–æ–ª–µ–µ –ø–æ—Å–ª–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –∑–∞ –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏; \n"
                "ÔÉº –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–º —Ä–∞–∑–≤–∏—Ç–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è. \n"
                "–ò\n\n"
                "–ù–∞–ª–∏—á–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–Ω–µ–≤–º–æ–Ω–∏–∏ –ø—Ä–∏ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–ª–∏ –ö–¢- 25 —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –≥—Ä—É–¥–Ω–æ–π –∫–ª–µ—Ç–∫–∏ (–∏–Ω—Ñ–∏–ª—å—Ç—Ä–∞—Ç, –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è, –∫–∞–≤–∏—Ç–∞—Ü–∏—è) \n"
                "–ò\n\n"
                "–ù–µ –º–µ–Ω–µ–µ –¥–≤—É—Ö –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤:\n"
                "1) –ª–∏—Ö–æ—Ä–∞–¥–∫–∞ > 38,0¬∞C –±–µ–∑ –¥—Ä—É–≥–∏—Ö –ø—Ä–∏—á–∏–Ω; \n"
                "2) –ª–µ–π–∫–æ–ø–µ–Ω–∏—è (< 4 000 –ª–µ–π–∫–æ—Ü–∏—Ç–æ–≤/–º–º3 ) –∏–ª–∏ –ª–µ–π–∫–æ—Ü–∏—Ç–æ–∑ (‚â• 12 000 –ª–µ–π–∫–æ—Ü–∏—Ç–æ–≤/–º–º3 ). \n"
                "3) –≤–Ω–æ–≤—å –ø–æ—è–≤–∏–≤—à–∞—è—Å—è –≥–Ω–æ–π–Ω–∞—è –º–æ–∫—Ä–æ—Ç–∞ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –º–æ–∫—Ä–æ—Ç—ã (—Ü–≤–µ—Ç, –∑–∞–ø–∞—Ö, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ü–∏—è); \n"
                "4) –∫–∞—à–µ–ª—å, –¥–∏—Å–ø–Ω–æ—ç –∏–ª–∏ —Ç–∞—Ö–∏–ø–Ω–æ—ç;\n"
                "5) –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –ø—Ä–∏ –∞—É—Å–∫—É–ª—å—Ç–∞—Ü–∏–∏ (—Ö—Ä–∏–ø—ã, –∫—Ä–µ–ø–∏—Ç–∞—Ü–∏—è –∏–ª–∏ –∑–≤—É–∫–∏ –±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω–æ–≥–æ –¥—ã—Ö–∞–Ω–∏—è); \n"
                "6) —É—Ö—É–¥—à–µ–Ω–∏–µ –≥–∞–∑–æ–æ–±–º–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, O2- –¥–µ—Å–∞—Ç—É—Ä–∞—Ü–∏—è –∏–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤ –∫–∏—Å–ª–æ—Ä–æ–¥–µ –∏–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤ –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏).\n\n"
                "–ü—Ä–∏–º–µ—á–∞–Ω–∏—è: \n"
                "** –£ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º–∏ —Å–µ—Ä–¥—Ü–∞ –∏–ª–∏ –ª–µ–≥–∫–∏—Ö (—Ä–µ—Å–ø–∏—Ä–∞—Ç–æ—Ä–Ω—ã–π –¥–∏—Å—Ç—Ä–µ—Å—Å-—Å–∏–Ω–¥—Ä–æ–º, –±—Ä–æ–Ω—Ö–æ-–ª–µ–≥–æ—á–Ω–∞—è –¥–∏—Å–ø–ª–∞–∑–∏—è, –æ—Ç–µ–∫ –ª–µ–≥–∫–∏—Ö, —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∞—è –æ–±—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∞—è –±–æ–ª–µ–∑–Ω—å –ª–µ–≥–∫–∏—Ö –∏ –¥—Ä.) –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –ö–¢-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–µ–≥–∫–∏—Ö."
            ),
            "–ø–Ω–µ–≤–º–æ–Ω–∏–∏ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ": (
                "ÔÉº —Ä–∞–∑–≤–∏–ª–∞—Å—å —á–µ—Ä–µ–∑ 48 —á–∞—Å–æ–≤ –∏ –±–æ–ª–µ–µ –ø–æ—Å–ª–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –∑–∞ –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏; \n"
                "ÔÉº –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–º —Ä–∞–∑–≤–∏—Ç–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è. \n"
                "–ò \n\n"
                "1. –ù–∞–ª–∏—á–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–Ω–µ–≤–º–æ–Ω–∏–∏ –ø—Ä–∏ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–ª–∏ –ö–¢-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –≥—Ä—É–¥–Ω–æ–π –∫–ª–µ—Ç–∫–∏*, ** \n"
                "–ò \n\n"
                "2. –ö–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤: \n"
                "ÔÉº –ª–∏—Ö–æ—Ä–∞–¥–∫–∞ > 38,0¬∞C –±–µ–∑ –¥—Ä—É–≥–∏—Ö –ø—Ä–∏—á–∏–Ω: \n"
                "ÔÉº –ª–µ–π–∫–æ–ø–µ–Ω–∏—è (< 4 000 –ª–µ–π–∫–æ—Ü–∏—Ç–æ–≤/–º–º3 ) –∏–ª–∏ –ª–µ–π–∫–æ—Ü–∏—Ç–æ–∑ (‚â• 12 000 –ª–µ–π–∫–æ—Ü–∏—Ç–æ–≤/–º–º3 ). \n"
                "–ò \n\n"
                "3. –û–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤ (–∏–ª–∏ –Ω–µ –º–µ–Ω–µ–µ –¥–≤—É—Ö, –µ—Å–ª–∏ –∏–º–µ–µ—Ç—Å—è –≤—ã—Å–µ–≤ –∫—É–ª—å—Ç—É—Ä—ã –∏–∑ –º–æ–∫—Ä–æ—Ç—ã –∏–ª–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –Ω–µ–∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å–µ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –∏–∑ –Ω–∏–∂–Ω–∏—Ö –æ—Ç–¥–µ–ª–æ–≤ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π): \n"
                "ÔÉº –≤–Ω–æ–≤—å –ø–æ—è–≤–∏–≤—à–∞—è—Å—è –≥–Ω–æ–π–Ω–∞—è –º–æ–∫—Ä–æ—Ç–∞, –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –º–æ–∫—Ä–æ—Ç—ã (—Ü–≤–µ—Ç, –∑–∞–ø–∞—Ö, 26 –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ü–∏—è);\n"
                "ÔÉº –∫–∞—à–µ–ª—å, –¥–∏—Å–ø–Ω–æ—ç –∏–ª–∏ —Ç–∞—Ö–∏–ø–Ω–æ—ç;\n"
                "ÔÉº –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –ø—Ä–∏ –∞—É—Å–∫—É–ª—å—Ç–∞—Ü–∏–∏ (—Ö—Ä–∏–ø—ã, –∫—Ä–µ–ø–∏—Ç–∞—Ü–∏—è –∏–ª–∏ –∑–≤—É–∫–∏ –±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω–æ–≥–æ –¥—ã—Ö–∞–Ω–∏—è);\n"
                "ÔÉº —É—Ö—É–¥—à–µ–Ω–∏–µ –≥–∞–∑–æ–æ–±–º–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, O2- –¥–µ—Å–∞—Ç—É—Ä–∞—Ü–∏—è –∏–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤ –∫–∏—Å–ª–æ—Ä–æ–¥–µ, –∏–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤ –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏). \n"
                "–ò \n\n"
                "4. –ö–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π: \n"
                "ÔÉº –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã—Å–µ–≤ –∏–∑ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –∫–æ–Ω—Ç–∞–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞–∑—Ü–æ–≤ –Ω–∏–∂–Ω–∏—Ö –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π —Å –ø–æ—Ä–æ–≥–æ–≤–æ–π –≤–µ–ª–∏—á–∏–Ω–æ–π: \n"
                "‚Ä¢ –ø—Ä–∏ –±—Ä–æ–Ω—Ö–æ-–∞–ª—å–≤–µ–æ–ª—è—Ä–Ω–æ–º –ª–∞–≤–∞–∂–µ (–ë–ê–õ) > 10*4 –ö–û–ï/–º–ª –∏–ª–∏ –ø—Ä–∏ –ø—Ä—è–º–æ–º –º–∏–∫—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ ‚â• 5% –∫–ª–µ—Ç–æ–∫, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –±–∞–∫—Ç–µ—Ä–∏–∏, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏–∫–ª–µ—Ç–æ—á–Ω–æ; \n"
                "‚Ä¢ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π —â–µ—Ç–∫–æ–π > 10*3 –ö–û–ï/–º–ª; \n"
                "‚Ä¢ –¥–∏—Å—Ç–∞–ª—å–Ω–æ–π –∑–∞—â–∏—â–µ–Ω–Ω–æ–π –∞—Å–ø–∏—Ä–∞—Ü–∏–µ–π > 10*3 –ö–û–ï/–º–ª.\n"
                "ÔÉº –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã—Å–µ–≤ –∏–∑ –≤–æ–∑–º–æ–∂–Ω–æ –∫–æ–Ω—Ç–∞–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–∑—Ü–∞ —Å –ø–æ—Ä–æ–≥–æ–≤–æ–π –≤–µ–ª–∏—á–∏–Ω–æ–π: \n"
                "‚Ä¢ –∏–∑ –æ–±—Ä–∞–∑—Ü–∞ –Ω–∏–∂–Ω–∏—Ö –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —ç–Ω–¥–æ—Ç—Ä–∞—Ö–µ–∞–ª—å–Ω—ã–π –∞—Å–ø–∏—Ä–∞—Ç) 10*6 –ö–û–ï/–º–ª. \n"
                "ÔÉº –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã—Å–µ–≤ –∏–∑ –∫—Ä–æ–≤–∏, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –∏–Ω—Ñ–µ–∫—Ü–∏–µ–π –¥—Ä—É–≥–æ–π –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏; - –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã—Å–µ–≤ –∏–∑ –∞—Å–ø–∏—Ä–∞—Ç–∞ –ø—Ä–∏ –ø—É–Ω–∫—Ü–∏–∏ –ª–µ–≥–æ—á–Ω–æ–≥–æ –∞–±—Å—Ü–µ—Å—Å–∞; \n"
                "ÔÉº –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ—Å–ø–∏—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –≤–∏—Ä—É—Å–æ–≤ (–≥—Ä–∏–ø–ø–∞, –†–°-–í–∏—Ä—É—Å—ã, –∞–¥–µ–Ω–æ–≤–∏—Ä—É—Å—ã, –∫–æ—Ä–æ–Ω–∞–≤–∏—Ä—É—Å—ã, –±–æ–∫–∞–≤–∏—Ä—É—Å—ã, –º–µ—Ç–∞–ø–Ω–µ–≤–º–æ–≤–∏—Ä—É—Å—ã –∏ –¥—Ä.) –∏–ª–∏ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Legionella spp., Aspergillus spp., –∏ –¥—Ä—É–≥–∏–µ): \n"
                "‚Ä¢ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤–∏—Ä—É—Å–Ω—ã—Ö –∞–Ω—Ç–∏–≥–µ–Ω–æ–≤ –∏–ª–∏ –∞–Ω—Ç–∏—Ç–µ–ª –≤ —Ä–µ—Å–ø–∏—Ä–∞—Ç–æ—Ä–Ω–æ–º —Å–µ–∫—Ä–µ—Ç–µ (–º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ-–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏, –∏–º–º—É–Ω–æ—Ö—Ä–æ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏); \n"
                "‚Ä¢ —Å–µ—Ä–æ–∫–æ–Ω–≤–µ—Ä—Å–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∏—Ä—É—Å –≥—Ä–∏–ø–ø–∞, Legionella spp., Mycoplasma spp.); \n"
                "‚Ä¢ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω—Ç–∏–≥–µ–Ω–æ–≤ –≤ –º–æ—á–µ 27 (Legionella spp., S. Pneumoniae). - –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã—Å–µ–≤ –∏–∑ –º–æ–∫—Ä–æ—Ç—ã***\n\n"
                "–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:\n"
                "‚Ä¢ * –ò–Ω—Ñ–∏–ª—å—Ç—Ä–∞—Ç, –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è, –∫–∞–≤–∏—Ç–∞—Ü–∏—è \n"
                "‚Ä¢ ** –£ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º–∏ —Å–µ—Ä–¥—Ü–∞ –∏–ª–∏ –ª–µ–≥–∫–∏—Ö (—Ä–µ—Å–ø–∏—Ä–∞—Ç–æ—Ä–Ω—ã–π –¥–∏—Å—Ç—Ä–µ—Å—Å-—Å–∏–Ω–¥—Ä–æ–º, –±—Ä–æ–Ω—Ö–æ - –ª–µ–≥–æ—á–Ω–∞—è –¥–∏—Å–ø–ª–∞–∑–∏—è, –æ—Ç–µ–∫ –ª–µ–≥–∫–∏—Ö, —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∞—è –æ–±—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∞—è –±–æ–ª–µ–∑–Ω—å –ª–µ–≥–∫–∏—Ö –∏ –¥—Ä.) –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–Ω—Ç–≥–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –ö–¢-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–µ–≥–∫–∏—Ö \n"
                "‚Ä¢ *** –î–∞–Ω–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ü–µ–ª—è—Ö —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏."
            ),
            "–ò–í–õ-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–Ω–µ–≤–º–æ–Ω–∏–∏": (
                "1. –ü–Ω–µ–≤–º–æ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–π –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–µ–π –ª–µ–≥–∫–∏—Ö (–ò–í–õ)*, –µ—Å–ª–∏ –ø–Ω–µ–≤–º–æ–Ω–∏—è —Ä–∞–∑–≤–∏–ª–∞—Å—å –Ω–µ —Ä–∞–Ω–µ–µ, —á–µ–º —á–µ—Ä–µ–∑ 48 —á –æ—Ç –º–æ–º–µ–Ω—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ò–í–õ, –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ª–µ–≥–æ—á–Ω–æ–π –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –Ω–∞—á–∞–ª–∞ –ò–í–õ. ** \n"
                "–ò\n\n"
                "2. –î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏—è–º –ø–Ω–µ–≤–º–æ–Ω–∏–∏, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏, –±–µ–∑ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.\n"
                "–ò–õ–ò \n\n"
                "3. –î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏—è–º –ø–Ω–µ–≤–º–æ–Ω–∏–∏, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏, –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–æ–π. \n\n"
                "–ü—Ä–∏–º–µ—á–∞–Ω–∏—è: \n"
                "* –ö –ò–í–õ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Ä–µ—Å–ø–∏—Ä–∞—Ç–æ—Ä–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞, –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ–º–∞—è —á–µ—Ä–µ–∑ —Ç—Ä–∞—Ö–µ–æ—Å—Ç–æ–º—É –∏–ª–∏ —ç–Ω–¥–æ—Ç—Ä–∞—Ö–µ–∞–ª—å–Ω—É—é –∏–Ω—Ç—É–±–∞—Ü–∏—é. \n"
                "** –ï—Å–ª–∏ –ò–í–õ –±—ã–ª–∞ –Ω–∞—á–∞—Ç–∞ –≤ –¥–µ–Ω—å –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–∏–º–ø—Ç–æ–º–æ–≤ –ø–Ω–µ–≤–º–æ–Ω–∏–∏ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏–π, –ø–Ω–µ–≤–º–æ–Ω–∏—è –Ω–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –ò–í–õ."
            )
        }
        mk = ReplyKeyboardMarkup(build_menu(IDD_CRIT_MENU), resize_keyboard=True)
        await reply_safe(update, crit_map.get(text, "–¢–µ–∫—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω."), mk)
        return

    # === –ò–ú–ü ===
    if stack[-1] == "imp":
        if text == "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ò–ú–ü":
            msg = (
                "–ò–Ω—Ñ–µ–∫—Ü–∏–∏ –º–æ—á–µ–≤—ã–¥–µ–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π (–ò–ú–ü) - —ç—Ç–æ –≤–æ—Å–ø–∞–ª–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ, –≤—ã–∑–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ–º –∏ —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ–º –ø–∞—Ç–æ–≥–µ–Ω–Ω—ã—Ö –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ –≤ –æ–¥–Ω–æ–º –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ—Ç–¥–µ–ª–∞—Ö –º–æ—á–µ–≤—ã–¥–µ–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. –ò—Ö –¥–µ–ª—è—Ç –Ω–∞ \n"
                "- –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è —Å–∏–º–ø—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ò–ú–ü;\n"
                "- –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–∏–º–ø—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ò–ú–ü. \n"
                "- —Ç–∞–∫–∂–µ –≤—ã–¥–µ–ª—è—é—Ç –∫–∞—Ç–µ—Ç–µ—Ä-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ò–ú–ü"
            )
            mk = ReplyKeyboardMarkup(build_menu(IMP_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        elif text == "–í–∏–¥—ã –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ò–ú–ü":
            stack.append("imp_types")
            mk = ReplyKeyboardMarkup(build_menu(IMP_TYPES_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥ –ò–ú–ü:", reply_markup=mk)
        elif text == "–î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –ò–ú–ü":
            msg = (
                "–õ–µ—á–∞—â–∏–π –≤—Ä–∞—á –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –ò–ú–ü –¥–æ–ª–∂–µ–Ω:\n"
                "1) –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è —Å–≤–æ–µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏ –≤—Ä–∞—á–∞-—ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∞ –æ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –∏–Ω—Ñ–µ–∫—Ü–∏—é —É—Å—Ç–Ω–æ (–ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É) –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –ø–∏—Å—å–º–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–∏—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤:\n"
                "‚Ä¢ –§.–ò.–û. –ø–∞—Ü–∏–µ–Ω—Ç–∞, –Ω–æ–º–µ—Ä –≠–ú–ö;\n"
                "‚Ä¢ –Ω–∞–ª–∏—á–∏–µ –≤ –∞–Ω–∞–º–Ω–µ–∑–µ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞\n"
                "‚Ä¢ –¥–∞—Ç–∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–Ω–≤–∞–∑–∏–≤–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞;\n"
                "‚Ä¢ –¥–∞—Ç–∞ —Å–º–µ–Ω—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞/–∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏—Ö, –µ–≥–æ –ø—Ä–æ–º—ã–≤–∫–∏;\n"
                "‚Ä¢ –¥–∞—Ç–∞ —Å–∞–Ω–∞—Ü–∏–∏;\n"
                "‚Ä¢ –¥–∞—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–∏–º–ø—Ç–æ–º–æ–≤, —É–∫–∞–∑—ã–≤–∞—é—â–∏—Ö –Ω–∞ –ò–ú–ü;\n"
                "‚Ä¢ –≤–æ–∑–Ω–∏–∫—à–∏–µ —Å–∏–º–ø—Ç–æ–º—ã;\n\n"
                "2) –≤–∑—è—Ç—å –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–∑ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ (–¥–æ –Ω–∞—á–∞–ª–∞ –ø—Ä–∏–µ–º–∞ –∞–Ω—Ç–∏–º–∏–∫—Ä–æ–±–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤), —Å —Ü–µ–ª—å—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ –æ–ø—Ä–æ–≤–µ—Ä–∂–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ–∑–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ —ç—Ç–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –≤–æ–∑–±—É–¥–∏—Ç–µ–ª—è (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è;\n"
                "3) –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä, —Å–æ–≥–ª–∞—Å–Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏;\n"
                "4) –≤—ã—è–≤–∏—Ç—å –∫—Ä—É–≥ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –ª–∏—Ü (—Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Ä–∞—á—É —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥—É) –∏–∑ —á–∏—Å–ª–∞ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞;\n"
                "5) –ø—Ä–æ–≤–µ—Å—Ç–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö —Å –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è–º–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏);"
            )
            mk = ReplyKeyboardMarkup(build_menu(IMP_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(IMP_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –ò–ú–ü:", reply_markup=mk)
        return

    if stack[-1] == "imp_types":
        imp_map = {
            "–º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è —Å–∏–º–ø—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ò–ú–ü": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: \n"
                "1. –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏, –≤ —Ç–æ–º —á–∏—Å–ª–µ –≤ –∏–Ω–∫—É–±–∞—Ü–∏–æ–Ω–Ω–æ–º –ø–µ—Ä–∏–æ–¥–µ. \n"
                "2. –ù–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–º —Ä–∞–∑–≤–∏—Ç–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è. \n"
                "–ò\n"
                "3. –£ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –µ—Å—Ç—å, –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤ –±–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ –¥—Ä—É–≥–æ–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –ø—Ä–∏—á–∏–Ω—ã: \n"
                "- –ª–∏—Ö–æ—Ä–∞–¥–∫–∞ (> 38¬∞C); \n"
                "- —Ä–µ–∑–∫–∏–µ –ø–æ–∑—ã–≤—ã –∫ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏—é; \n"
                "- —É—á–∞—â–µ–Ω–Ω–æ–µ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–µ; \n"
                "- –¥–∏–∑—É—Ä–∏—è –∏–ª–∏ –≤ –±–æ–ª–µ–∑–Ω–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞–¥–ª–æ–±–∫–æ–≤–æ–π –æ–±–ª–∞—Å—Ç–∏.\n"
                "–ò \n"
                "4. –ü–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –æ–¥–Ω–æ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö: \n"
                "- –≤—ã–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–∫—É–ª—å—Ç—É—Ä—ã –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ ‚â• 105 –ö–û–ï/–º–ª –º–æ—á–∏, –Ω–µ –±–æ–ª–µ–µ, —á–µ–º 2 –≤–∏–¥–æ–≤ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤; \n"
                "- –¥–≤–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ —É—Ä–æ–∫—É–ª—å—Ç—É—Ä—ã –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ ‚â• 102 –ö–û–ï/–º–ª –∏–∑ –ø—Ä–æ–±, –≤–∑—è—Ç—ã—Ö –∞—Å–µ–ø—Ç–∏—á–µ—Å–∫–∏; \n"
                "- –æ–¥–Ω–∞ —É—Ä–æ–∫—É–ª—å—Ç—É—Ä–∞ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ ‚â§ 105 –ö–û–ï/–º–ª —É –ø–∞—Ü–∏–µ–Ω—Ç–∞, –ø–æ–ª—É—á–∞—é—â–µ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∞–Ω—Ç–∏–º–∏–∫—Ä–æ–±–Ω—É—é —Ç–µ—Ä–∞–ø–∏—é."
            ),
            "–Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–∏–º–ø—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ò–ú–ü": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: \n"
                "- –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏, –≤ —Ç–æ–º —á–∏—Å–ª–µ –≤ –∏–Ω–∫—É–±–∞—Ü–∏–æ–Ω–Ω–æ–º –ø–µ—Ä–∏–æ–¥–µ; \n"
                "- –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–º —Ä–∞–∑–≤–∏—Ç–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è. \n"
                "–ò\n"
                "2. –£ –ø–∞—Ü–∏–µ–Ω—Ç–∞, –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤ –±–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ –¥—Ä—É–≥–æ–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –ø—Ä–∏—á–∏–Ω—ã: \n"
                "- –ª–∏—Ö–æ—Ä–∞–¥–∫–∞ (> 38¬∞C); \n"
                "- —Ä–µ–∑–∫–∏–µ –ø–æ–∑—ã–≤—ã –∫ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏—é; \n"
                "- —É—á–∞—â–µ–Ω–Ω–æ–µ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–µ; \n"
                "- –¥–∏–∑—É—Ä–∏—è –∏–ª–∏ –±–æ–ª–µ–∑–Ω–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞–¥–ª–æ–±–∫–æ–≤–æ–π –æ–±–ª–∞—Å—Ç–∏. \n"
                "–ò\n"
                "3. –ü–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –æ–¥–Ω–æ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö: \n"
                "- –ø–∏—É—Ä–∏—è —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ª–µ–π–∫–æ—Ü–∏—Ç–æ–≤ ‚â• 10 –≤ 1 –º–ª –∏–ª–∏ ‚â• 3 –ª–µ–π–∫–æ—Ü–∏—Ç–∞ –≤ –ø–æ–ª–µ –∑—Ä–µ–Ω–∏–µ –ø—Ä–∏ –º–∏–∫—Ä–æ—Å–∫–æ–ø–∏–∏ —Å –≤—ã—Å–æ–∫–∏–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –æ–±—Ä–∞–∑—Ü–∞ –Ω–µ—Ü–µ–Ω—Ç—Ä–∏—Ñ—É–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ—á–∏;\n"
                "- –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ–º –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞ –ø—Ä–∏ –æ–∫—Ä–∞—Å–∫–µ –ø–æ –ì—Ä–∞–º—É –æ–±—Ä–∞–∑—Ü–∞ –Ω–µ—Ü–µ–Ω—Ç—Ä–∏—Ñ—É–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ—á–∏; \n"
                "- –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä–∞—á–æ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∞–Ω—Ç–∏–º–∏–∫—Ä–æ–±–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏. "
            ),
            "–∫–∞—Ç–µ—Ç–µ—Ä-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ò–ú–ü": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: \n"
                "1.–ö–∞—Ç–µ—Ç–µ—Ä-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ò–ú–ü —Å—á–∏—Ç–∞–µ—Ç—Å—è –∏–Ω—Ñ–µ–∫—Ü–∏—è, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º –ò–ú–ü. \n"
                "–ò\n"
                "2.–í–æ–∑–Ω–∏–∫—à–∞—è —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –Ω–µ —Ä–∞–Ω–µ–µ, —á–µ–º —á–µ—Ä–µ–∑ 48 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –º–æ—á–µ–≤–æ–≥–æ –∫–∞—Ç–µ—Ç–µ—Ä–∞. \n"
                "–ò–õ–ò\n"
                "3.–í–æ–∑–Ω–∏–∫—à–∞—è —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –º–æ—á–µ–≤–æ–≥–æ –∫–∞—Ç–µ—Ç–µ—Ä–∞, —Å—Ç–æ—è–≤—à–µ–≥–æ –Ω–µ –º–µ–Ω–µ–µ 48 —á–∞—Å–æ–≤."
            )
        }
        mk = ReplyKeyboardMarkup(build_menu(IMP_TYPES_MENU), resize_keyboard=True)
        await reply_safe(update, imp_map.get(text, "–¢–µ–∫—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω."), mk)
        return

    # === –ò–û–•–í ===
    if stack[-1] == "iohv":
        if text == "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ò–û–•–í":
            msg = (
                "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ - –∏–Ω—Ñ–µ–∫—Ü–∏—è —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑—Ä–µ–∑–∞, –æ—Ä–≥–∞–Ω–∞ –∏–ª–∏ –ø–æ–ª–æ—Å—Ç–∏, –≤–æ–∑–Ω–∏–∫–∞—é—â–∞—è –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö 30 –¥–Ω–µ–π –ø–æ—Å–ª–µ–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∏–º–ø–ª–∞–Ω—Ç–∞—Ç–∞ ‚Äì –¥–æ 90 –¥–Ω–µ–π). –î–µ–ª—è—Ç—Å—è –Ω–∞:\n"
                "1) –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞\n"
                "2) –ì–ª—É–±–æ–∫–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞\n"
                "3) –ò–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –æ—Ä–≥–∞–Ω–∞ –∏–ª–∏ –ø–æ–ª–æ—Å—Ç–∏"
            )
            mk = ReplyKeyboardMarkup(build_menu(IOHV_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        elif text == "–í–∏–¥—ã –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ò–û–•–í":
            stack.append("iohv_types")
            mk = ReplyKeyboardMarkup(build_menu(IOHV_TYPES_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ò–û–•–í:", reply_markup=mk)
        elif text == "–î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –ò–û–•–í":
            msg = (
                "1) –ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è —Å–≤–æ–µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏ –≤—Ä–∞—á–∞-—ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∞ –æ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –∏–Ω—Ñ–µ–∫—Ü–∏—é —É—Å—Ç–Ω–æ (–ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É) –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –ø–∏—Å—å–º–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–∏—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤:\n"
                "‚Ä¢ –§.–ò.–û. –ø–∞—Ü–∏–µ–Ω—Ç–∞, –Ω–æ–º–µ—Ä –≠–ú–ö;\n"
                "‚Ä¢ –Ω–∞–ª–∏—á–∏–µ –≤ –∞–Ω–∞–º–Ω–µ–∑–µ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞\n"
                "‚Ä¢ –¥–∞—Ç–∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–Ω–≤–∞–∑–∏–≤–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞;\n"
                "‚Ä¢ –¥–∞—Ç–∞ —Å–º–µ–Ω—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞/–∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏—Ö, –µ–≥–æ –ø—Ä–æ–º—ã–≤–∫–∏;\n"
                "‚Ä¢ –¥–∞—Ç–∞ —Å–∞–Ω–∞—Ü–∏–∏;\n"
                "‚Ä¢ –¥–∞—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–∏–º–ø—Ç–æ–º–æ–≤, —É–∫–∞–∑—ã–≤–∞—é—â–∏—Ö –Ω–∞ –ò–û–•–í;\n"
                "‚Ä¢ –≤–æ–∑–Ω–∏–∫—à–∏–µ —Å–∏–º–ø—Ç–æ–º—ã;\n"
                "2) –≤–∑—è—Ç—å –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–∑ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ (–¥–æ –Ω–∞—á–∞–ª–∞ –ø—Ä–∏–µ–º–∞ –∞–Ω—Ç–∏–º–∏–∫—Ä–æ–±–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤), —Å —Ü–µ–ª—å—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ –æ–ø—Ä–æ–≤–µ—Ä–∂–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ–∑–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ —ç—Ç–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –≤–æ–∑–±—É–¥–∏—Ç–µ–ª—è (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è;\n"
                "3) –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä, —Å–æ–≥–ª–∞—Å–Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏;\n"
                "4) –≤—ã—è–≤–∏—Ç—å –∫—Ä—É–≥ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –ª–∏—Ü (—Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Ä–∞—á—É —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥—É) –∏–∑ —á–∏—Å–ª–∞ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞;\n"
                "5) –ø—Ä–æ–≤–µ—Å—Ç–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö —Å –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è–º–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è;"
            )
            mk = ReplyKeyboardMarkup(build_menu(IOHV_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(IOHV_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –ò–û–•–í:", reply_markup=mk)
        return

    if stack[-1] == "iohv_types":
        iohv_map = {
            "–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞": (
                "1) –ö—Ä–∏—Ç–µ—Ä–∏–∏:\n"
                "‚Ä¢ –∏–º–µ–µ—Ç —Å–≤—è–∑—å —Å —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–º –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º;\n"
                "‚Ä¢ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–º —Ä–∞–∑–≤–∏—Ç–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è;\n"
                "‚Ä¢ –≤–∫–ª—é—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–∂—É –∏ –ø–æ–¥–∫–æ–∂–Ω—É—é –∫–ª–µ—Ç—á–∞—Ç–∫—É;\n"
                "‚Ä¢ —Å—Ä–æ–∫ —Ä–∞–∑–≤–∏—Ç–∏—è –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 30 –¥–Ω–µ–π –ø–æ—Å–ª–µ –ª—é–±–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ (–ø–µ—Ä–≤—ã–º –¥–Ω—ë–º —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–µ–Ω—å —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞).\n"
                "2) –ü—Ä–∏–∑–Ω–∞–∫–∏ 1-–π  –≥—Ä—É–ø–ø—ã:\n"
                "‚Ä¢ –≥–Ω–æ–π–Ω–æ–µ –æ—Ç–¥–µ–ª—è–µ–º–æ–µ –∏–∑ —Ä–∞–Ω—ã;\n"
                "‚Ä¢ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ –∏–∑ –∂–∏–¥–∫–æ—Å—Ç–∏ –∏–ª–∏ —Ç–∫–∞–Ω–∏, –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –∞—Å–µ–ø—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ–∑–∞ –∏–ª–∏ –ø–æ–¥–∫–æ–∂–Ω–æ–π –∫–ª–µ—Ç—á–∞—Ç–∫–∏ –∫—É–ª—å—Ç—É—Ä–∞–ª—å–Ω—ã–º –∏–ª–∏ –¥—Ä—É–≥–∏–º –º–µ—Ç–æ–¥–æ–º;\n"
                "‚Ä¢ —Ö–∏—Ä—É—Ä–≥ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ä–∞–Ω—É, –ø—Ä–∏ —ç—Ç–æ–º –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –Ω–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ;\n"
                "3) –ü—Ä–∏–∑–Ω–∞–∫–∏ 2 -–π –≥—Ä—É–ø–ø—ã:\n"
                "‚Ä¢ –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ (–±–æ–ª—å, –≥–∏–ø–µ—Ä–µ–º–∏—è, –æ—Ç—ë–∫) —Å –≥–∏–ø–µ—Ä—Ç–µ—Ä–º–∏–µ–π –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–µ—Ö —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –ø–æ—Å–µ–≤ –æ—Ç–¥–µ–ª—è–µ–º–æ–≥–æ —Ä–∞–Ω—ã –¥–∞—ë—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç;\n"
                "‚Ä¢ —Ö–∏—Ä—É—Ä–≥ –∏–ª–∏ –ª–µ—á–∞—â–∏–π –≤—Ä–∞—á –ø–æ—Å—Ç–∞–≤–∏–ª –¥–∏–∞–≥–Ω–æ–∑ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞."
            ),
            "–ì–ª—É–±–æ–∫–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞": (
                "1) –ö—Ä–∏—Ç–µ—Ä–∏–∏:\n"
                "‚Ä¢ –∏–º–µ–µ—Ç —Å–≤—è–∑—å —Å —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–º –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º;\n"
                "‚Ä¢ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–º —Ä–∞–∑–≤–∏—Ç–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è;\n"
                "‚Ä¢ –≤–æ–≤–ª–µ–∫–∞–µ—Ç –≤ –≥–Ω–æ–π–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≥–ª—É–±–æ–∫–∏–µ –º—è–≥–∫–∏–µ —Ç–∫–∞–Ω–∏ (—Ñ–∞—Å—Ü–∏–∞–ª—å–Ω—ã–π –∏ –º—ã—à–µ—á–Ω—ã–π —Å–ª–æ–∏);\n"
                "‚Ä¢ —Å—Ä–æ–∫ —Ä–∞–∑–≤–∏—Ç–∏—è –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 30 –¥–Ω–µ–π –ø–æ—Å–ª–µ –ª—é–±–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ (–ø–µ—Ä–≤—ã–º –¥–Ω—ë–º —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–µ–Ω—å —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞), –∞ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∏–º–ø–ª–∞–Ω—Ç–∞—Ç–∞ ‚Äì 90 –¥–Ω–µ–π.\n"
                "2) –ü—Ä–∏–∑–Ω–∞–∫–∏ 1 –≥—Ä—É–ø–ø—ã:\n"
                "‚Ä¢ –≥–Ω–æ–π–Ω–æ–µ –æ—Ç–¥–µ–ª—è–µ–º–æ–µ –∏–∑ –≥–ª—É–±–∏–Ω—ã —Ä–∞–∑—Ä–µ–∑–∞, –Ω–æ –Ω–µ –∏–∑ –æ—Ä–≥–∞–Ω–∞ (–ø–æ–ª–æ—Å—Ç–∏) –≤ –º–µ—Å—Ç–µ –¥–∞–Ω–Ω–æ–≥–æ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞;\n"
                "‚Ä¢ —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –∫—Ä–∞—ë–≤ —Ä–∞–Ω—ã –∏–ª–∏ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–µ –µ—ë –æ—Ç–∫—Ä—ã—Ç–∏–µ —Ö–∏—Ä—É—Ä–≥–æ–º, –∫–æ–≥–¥–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–º–µ—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –∏ –ª—é–±—ã–º –º–µ—Ç–æ–¥–æ–º –≤—ã–¥–µ–ª–µ–Ω –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º;\n"
                "3) –ü—Ä–∏–∑–Ω–∞–∫–∏ 2 –≥—Ä—É–ø–ø—ã:\n"
                "‚Ä¢ –ª–∏—Ö–æ—Ä–∞–¥–∫–∞ (> 38¬∞C), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –±–æ–ª—å, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–µ—Ö —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –ø–æ—Å–µ–≤ –∏–∑ —Ä–∞–Ω—ã –¥–∞—ë—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã;\n"
                "‚Ä¢ –ø—Ä–∏ –æ—Å–º–æ—Ç—Ä–µ, –≤–æ –≤—Ä–µ–º—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏, –ø—Ä–∏ –≥–∏—Å—Ç–æ–ø–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –∏–ª–∏ –ª—É—á–µ–≤–æ–º –º–µ—Ç–æ–¥–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω –∞–±—Å—Ü–µ—Å—Å –∏–ª–∏ –∏–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –≤ –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑—Ä–µ–∑–∞."
            ),
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –æ—Ä–≥–∞–Ω–∞ –∏–ª–∏ –ø–æ–ª–æ—Å—Ç–∏": (
                "1) –ö—Ä–∏—Ç–µ—Ä–∏–∏:\n"
                "‚Ä¢ –∏–º–µ–µ—Ç —Å–≤—è–∑—å —Å —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–º –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º;\n"
                "‚Ä¢ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–º —Ä–∞–∑–≤–∏—Ç–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è;\n"
                "‚Ä¢ —Å—Ä–æ–∫ —Ä–∞–∑–≤–∏—Ç–∏—è –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 30 –¥–Ω–µ–π –ø–æ—Å–ª–µ –ª—é–±–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ (–ø–µ—Ä–≤—ã–º –¥–Ω—ë–º —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–µ–Ω—å —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞), –∞ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∏–º–ø–ª–∞–Ω—Ç–∞—Ç–∞ ‚Äì 90 –¥–Ω–µ–π;\n"
                "‚Ä¢ –≤–æ–≤–ª–µ–∫–∞–µ—Ç –≤ –≥–Ω–æ–π–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ—Ä–≥–∞–Ω—ã (–ø–æ–ª–æ—Å—Ç–∏), –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –æ—Ç–∫—Ä—ã—Ç—ã –∏–ª–∏ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã –≤–æ –≤—Ä–µ–º—è –æ–ø–µ—Ä–∞—Ü–∏–∏, –∏—Å–∫–ª—é—á–∞—è –∫–æ–∂—É, –ø–æ–¥–∫–æ–∂–Ω—É—é –∫–ª–µ—Ç—á–∞—Ç–∫—É –∏ –≥–ª—É–±–æ–∫–∏–µ –º—è–≥–∫–∏–µ —Ç–∫–∞–Ω–∏ (—Ñ–∞—Å—Ü–∏–∞–ª—å–Ω—ã–π –∏ –º—ã—à–µ—á–Ω—ã–π —Å–ª–æ–∏).\n"
                "2) –ü—Ä–∏–∑–Ω–∞–∫–∏ 1 –≥—Ä—É–ø–ø—ã:\n"
                "‚Ä¢ –≥–Ω–æ–π–Ω–æ–µ –æ—Ç–¥–µ–ª—è–µ–º–æ–µ –∏–∑ –¥—Ä–µ–Ω–∞–∂–∞, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –≤ –æ—Ä–≥–∞–Ω–µ (–ø–æ–ª–æ—Å—Ç–∏);\n"
                "‚Ä¢ —Å–≤–∏—â–µ–≤–æ–π —Ö–æ–¥, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –∏–º–ø–ª–∞–Ω—Ç–æ–º;\n"
                "‚Ä¢ –≥–Ω–æ–π–Ω–æ–µ –æ—Ç–¥–µ–ª—è–µ–º–æ–µ –≤ –æ–±–ª–∞—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–º–ø–ª–∞–Ω—Ç–∞;\n"
                "‚Ä¢ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ –∏–∑ –∂–∏–¥–∫–æ—Å—Ç–∏ –∏–ª–∏ —Ç–∫–∞–Ω–∏, –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –∞—Å–µ–ø—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –æ—Ä–≥–∞–Ω–∞ (–ø–æ–ª–æ—Å—Ç–∏) –ª—é–±—ã–º –º–µ—Ç–æ–¥–æ–º.\n"
                "3) –ü—Ä–∏–∑–Ω–∞–∫–∏ 2 –≥—Ä—É–ø–ø—ã:\n"
                "‚Ä¢ –ø—Ä–∏ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º –æ—Å–º–æ—Ç—Ä–µ, –≤–æ –≤—Ä–µ–º—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏, –ø—Ä–∏ –≥–∏—Å—Ç–æ–ø–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –∏–ª–∏ –ª—É—á–µ–≤–æ–º –º–µ—Ç–æ–¥–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–±—Å—Ü–µ—Å—Å–∞ –∏–ª–∏ –∏–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–Ω—Ñ–µ–∫—Ü–∏–∏, –≤–æ–≤–ª–µ–∫–∞—é—â–µ–π –æ—Ä–≥–∞–Ω –∏–ª–∏ –ø–æ–ª–æ—Å—Ç—å."
            )
        }
        mk = ReplyKeyboardMarkup(build_menu(IOHV_TYPES_MENU), resize_keyboard=True)
        await reply_safe(update, iohv_map.get(text, "–¢–µ–∫—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω."), mk)
        return

    # === –ò–ö ===
    if stack[-1] == "ik":
        if text == "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ò–ö":
            msg = (
                "–ò–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞ - –∏–Ω—Ñ–µ–∫—Ü–∏—è –ª—é–±–æ–π —ç—Ç–∏–æ–ª–æ–≥–∏–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ—Å–µ–≤ –∫—Ä–æ–≤–∏ —Å–≤—è–∑–∞–Ω —Å –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏ —Å–∏–º–ø—Ç–æ–º–∞–º–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏.\n"
                "–ö–∞—Ç–µ—Ç–µ—Ä –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞ - –ø–µ—Ä–≤–∏—á–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–∑–≤–∏–ª–∞—Å—å —á–µ—Ä–µ–∑ 48 —á–∞—Å–æ–≤ –∏ –±–æ–ª–µ–µ –ø–æ—Å–ª–µ –≤–≤–µ–¥–µ–Ω–∏—è –≤ –∫—Ä–æ–≤–µ–Ω–æ—Å–Ω–æ–µ —Ä—É—Å–ª–æ –∫–∞—Ç–µ—Ç–µ—Ä–∞ –∏ –Ω–µ—Ç —Å–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏–Ω—Ñ–µ–∫—Ü–∏–∏.\n"
                "–ò–Ω—Ñ–µ–∫—Ü–∏—è, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å —Å–æ—Å—É–¥–∏—Å—Ç—ã–º –∫–∞—Ç–µ—Ç–µ—Ä–æ–º ‚Äì —ç—Ç–æ –º–µ—Å—Ç–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –≤ —Ä–∞–Ω–µ –≤—Ö–æ–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞ –∏ –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å —Å–æ—Å—É–¥–∏—Å—Ç—ã–º –∫–∞—Ç–µ—Ç–µ—Ä–æ–º –ø—Ä–∏ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ —Ä–æ–ª–∏ —Å–æ—Å—É–¥–∏—Å—Ç–æ–≥–æ –∫–∞—Ç–µ—Ç–µ—Ä–∞ –∫–∞–∫ —Ñ–∞–∫—Ç–æ—Ä–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –≤–æ–∑–±—É–¥–∏—Ç–µ–ª—è –∏–Ω—Ñ–µ–∫—Ü–∏–∏."
            )
            mk = ReplyKeyboardMarkup(build_menu(IK_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        elif text == "–í–∏–¥—ã –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ò–ö":
            stack.append("ik_types")
            mk = ReplyKeyboardMarkup(build_menu(IK_TYPES_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –∫—Ä–æ–≤–æ—Ç–æ–∫–∞:", reply_markup=mk)
        elif text == "–î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –ò–ö":
            msg = (
                "1) –õ–µ—á–∞—â–∏–π –≤—Ä–∞—á –∏–Ω—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è —Å–≤–æ–µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏ –≤—Ä–∞—á–µ–π-—ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–æ–≤ –æ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –∏–Ω—Ñ–µ–∫—Ü–∏—é –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –ø–∏—Å—å–º–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–∏—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤:\n"
                "‚Ä¢ –§.–ò.–û. –ø–∞—Ü–∏–µ–Ω—Ç–∞, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è, –Ω–æ–º–µ—Ä –≠–ú–ö;\n"
                "‚Ä¢ –¥–∞—Ç–∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–∞—Ç–µ—Ç–µ—Ä–∞, –µ–≥–æ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è;\n"
                "‚Ä¢ –¥–∞—Ç–∞ —Å–º–µ–Ω—ã –∫–∞—Ç–µ—Ç–µ—Ä–∞, –µ–≥–æ –ø—Ä–æ–º—ã–≤–∫–∏;\n"
                "‚Ä¢ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ—Ç–µ—Ä–∞;\n"
                "‚Ä¢ –¥–∞—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–∏–º–ø—Ç–æ–º–æ–≤, —É–∫–∞–∑—ã–≤–∞—é—â–∏—Ö –Ω–∞ –ö–ê–ò–ö;\n"
                "‚Ä¢ –≤–æ–∑–Ω–∏–∫—à–∏–µ —Å–∏–º–ø—Ç–æ–º—ã;\n"
                "2) –≤–∑—è—Ç—å –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–∑ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ (–¥–æ –Ω–∞—á–∞–ª–∞ –ø—Ä–∏–µ–º–∞ –∞–Ω—Ç–∏–º–∏–∫—Ä–æ–±–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤), —Å —Ü–µ–ª—å—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ –æ–ø—Ä–æ–≤–µ—Ä–∂–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ–∑–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ —ç—Ç–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –≤–æ–∑–±—É–¥–∏—Ç–µ–ª—è (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è;\n"
                "3) –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä, —Å–æ–≥–ª–∞—Å–Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏;\n"
                "4) –≤—ã—è–≤–∏—Ç—å –∫—Ä—É–≥ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –ª–∏—Ü (—Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Ä–∞—á—É —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥—É) –∏–∑ —á–∏—Å–ª–∞ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞;\n"
                "5) –ø—Ä–æ–≤–µ—Å—Ç–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö —Å –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è–º–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏);"
            )
            mk = ReplyKeyboardMarkup(build_menu(IK_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(IK_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –ò–ö:", reply_markup=mk)
        return

    if stack[-1] == "ik_types":
        ik_map = {
            "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: \n"
                "1. –û–¥–∏–Ω –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã—Å–µ–≤ –∏–∑ –∫—Ä–æ–≤–∏ –ø—Ä–∏–∑–Ω–∞–Ω–Ω–æ–≥–æ (–∑–Ω–∞—á–∏–º–æ–≥–æ) –ø–∞—Ç–æ–≥–µ–Ω–∞*. \n"
                "–ò–õ–ò \n"
                "2.1. –ü–∞—Ü–∏–µ–Ω—Ç –∏–º–µ–µ—Ç —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤: –ª–∏—Ö–æ—Ä–∞–¥–∫–∞ (> 38¬∞C), –æ–∑–Ω–æ–± –∏–ª–∏ –≥–∏–ø–æ—Ç–µ–Ω–∑–∏—è. \n"
                "–ò \n"
                "2.2. –ü–∞—Ü–∏–µ–Ω—Ç –∏–º–µ–µ—Ç –∏–∑ –∫—Ä–æ–≤–∏ –¥–≤–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –≤—ã—Å–µ–≤–∞ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞, –≤—Ö–æ–¥—è—â–µ–≥–æ –≤ —Å–æ—Å—Ç–∞–≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –º–∏–∫—Ä–æ—Ñ–ª–æ—Ä—ã –∫–æ–∂–∏** (–∏–∑ –¥–≤—É—Ö –æ—Ç–¥–µ–ª—å–Ω–æ –≤–∑—è—Ç—ã—Ö –ø–æ—Å–µ–≤–æ–≤ –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤). \n\n"
                "–ü—Ä–∏–º–µ—á–∞–Ω–∏—è: –í —Ü–µ–ª—è—Ö —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–¥–∑–æ—Ä–∞ –≤ –¥–∞–Ω–Ω–æ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Å–ª—É—á–∞—è –ø—Ä–∏–Ω—è—Ç–æ —Å–ª–µ–¥—É—é—â–µ–µ: \n"
                "- * –∫ –ø–∞—Ç–æ–≥–µ–Ω–Ω—ã–º –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞–º –æ—Ç–Ω–æ—Å—è—Ç—Å—è: Staphylococcus aureus, –ì—Ä–∞–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –±–∞–∫—Ç–µ—Ä–∏–∏ (Pseudomonas spp, Acinetobacter spp, Achromobacter spp, Stenotrophomonas maltophilia –∏ –¥—Ä.), –¥—Ä–æ–∂–∂–µ–ø–æ–¥–æ–±–Ω—ã–µ/ –ø–ª–µ—Å–Ω–µ–≤—ã–µ –≥—Ä–∏–±—ã; \n"
                "- ** –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –º–∏–∫—Ä–æ—Ñ–ª–æ—Ä–µ –∫–æ–∂–∏ –æ—Ç–Ω–µ—Å–µ–Ω—ã: –∫–æ–∞–≥—É–ª–∞–∑–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∞—Ñ–∏–ª–æ–∫–æ–∫–∫–∏, Micrococcus spp., Propionibacterium acne, Bacillus spp., Corynebacterium spp. –∏ –¥—Ä."
            ),
            "–ö–∞—Ç–µ—Ç–µ—Ä-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞ (–ö–ê–ò–ö)": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: \n"
                "1. –ö–∞—Ç–µ—Ç–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –±–æ–ª–µ–µ 48 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥ –¥–æ —Ä–∞–∑–≤–∏—Ç–∏—è –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –∫—Ä–æ–≤–æ—Ç–æ–∫–∞. \n"
                "–ò \n"
                "2. –ò—Å—Ç–æ—á–Ω–∏–∫–æ–º –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –¥—Ä—É–≥–æ–π –æ—á–∞–≥ –∏–Ω—Ñ–µ–∫—Ü–∏–∏. \n"
                "–ò: \n"
                "–ü–∞—Ü–∏–µ–Ω—Ç –∏–º–µ–µ—Ç, –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: \n"
                "3. –û–¥–∏–Ω –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã—Å–µ–≤ –∏–∑ –∫—Ä–æ–≤–∏ –ø—Ä–∏–∑–Ω–∞–Ω–Ω–æ–≥–æ –ø–∞—Ç–æ–≥–µ–Ω–∞.\n"
                "–ò–õ–ò\n"
                "4.1. –ü–∞—Ü–∏–µ–Ω—Ç –∏–º–µ–µ—Ç —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤: –ª–∏—Ö–æ—Ä–∞–¥–∫–∞ (> 38¬∞C), –æ–∑–Ω–æ–± –∏–ª–∏ –≥–∏–ø–æ—Ç–µ–Ω–∑–∏—è. \n"
                "–ò \n"
                "4.2. –î–≤–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –≤—ã—Å–µ–≤–∞ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞, –≤—Ö–æ–¥—è—â–µ–≥–æ –≤ —Å–æ—Å—Ç–∞–≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –º–∏–∫—Ä–æ—Ñ–ª–æ—Ä—ã –∫–æ–∂–∏ (–∏–∑ –¥–≤—É—Ö –æ—Ç–¥–µ–ª—å–Ω–æ –≤–∑—è—Ç—ã—Ö –ø–æ—Å–µ–≤–æ–≤ –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤), –∏–∑ –∫—Ä–æ–≤–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞. \n\n"
                "–ü—Ä–∏–º–µ—á–∞–Ω–∏—è: –î–∏–∞–≥–Ω–æ–∑ –ö–ê–ò–ö –±—É–¥–µ—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–º, –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å —Å–æ—Å—É–¥–∏—Å—Ç—ã–º –∫–∞—Ç–µ—Ç–µ—Ä–æ–º: \n"
                "‚Ä¢ –Ω–∞–±–ª—é–¥–∞–ª–∏—Å—å –∫–ª–∏–Ω–∏–∫–æ-–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –∫—Ä–æ–≤–æ—Ç–æ–∫–∞; \n"
                "‚Ä¢ –Ω–µ –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –¥—Ä—É–≥–∏–µ –æ—á–∞–≥–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏;\n"
                "‚Ä¢ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–¥–∞–ª–∏—Ç—å —Å–æ—Å—É–¥–∏—Å—Ç—ã–π –∫–∞—Ç–µ—Ç–µ—Ä –∏ –ø—Ä–æ–≤–µ—Å—Ç–∏ –µ–≥–æ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å —Ü–µ–ª—å—é –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ —ç—Ç–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ–≥–æ –∫–æ–Ω—Ç–∞–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞–º–∏ (—Ç.–µ. –Ω–µ —É–¥–∞–ª–æ—Å—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—É–¥–∏—Å—Ç—ã–π –∫–∞—Ç–µ—Ç–µ—Ä –∫–∞–∫ —Ñ–∞–∫—Ç–æ—Ä –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏). \n"
                "–î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–æ–ª–∏ –∫–∞—Ç–µ—Ç–µ—Ä–∞, –∫–∞–∫ –∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –∏ –µ–≥–æ —ç—Ç–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –≤ –ø–∞—Ç–æ–≥–µ–Ω–µ–∑–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –∫—Ä–æ–≤–æ—Ç–æ–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–∏—Å—Ç–∞–ª—å–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—É–¥–∏—Å—Ç–æ–≥–æ –∫–∞—Ç–µ—Ç–µ—Ä–∞. –ù–∞–∏–±–æ–ª–µ–µ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∏ –ø–æ–ª—É–∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥—ã –ø–æ—Å–µ–≤–∞ —Å–µ–≥–º–µ–Ω—Ç–∞ –∫–∞—Ç–µ—Ç–µ—Ä–∞. \n"
                "–í —Å–ª—É—á–∞–µ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–æ–ª–∏ —Å–æ—Å—É–¥–∏—Å—Ç–æ–≥–æ –∫–∞—Ç–µ—Ç–µ—Ä–∞, –∫–∞–∫ —Ñ–∞–∫—Ç–æ—Ä–∞ –ø–µ—Ä–µ–¥–∞—á–∏, –º–µ—Å—Ç–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –≤ —Ä–∞–Ω–µ –≤—Ö–æ–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞ –∏ –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å —Å–æ—Å—É–¥–∏—Å—Ç—ã–º –∫–∞—Ç–µ—Ç–µ—Ä–æ–º –±—É–¥—É—Ç –æ—Ç–Ω–µ—Å–µ–Ω—ã –∫ –≥—Ä—É–ø–ø–µ –∏–Ω—Ñ–µ–∫—Ü–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Å–æ—Å—É–¥–∏—Å—Ç—ã–º –∫–∞—Ç–µ—Ç–µ—Ä–æ–º."
            ),
            "–ò–ö —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –¶–í–ö (–±–µ–∑ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã—Å–µ–≤–∞ –∏–∑ –∫—Ä–æ–≤–∏)": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: \n"
                "1. –ö–∞—Ç–µ—Ç–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –±–æ–ª–µ–µ 48 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥.\n"
                "–ò\n"
                "2. –ì–Ω–æ–π/–≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ –≤ —Ä–∞–Ω–µ –≤—Ö–æ–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞. \n"
                "–ò \n"
                "3. –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å–µ–≤ –¶–í–ö ‚â• 10*3 –ö–û–ï/–º–ª –∏–ª–∏ –ø–æ–ª—É–∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å–µ–≤ –¶–í–ö > 15 –ö–û–ï. –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ú–µ—Å—Ç–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –¶–í–ö, –≤–∫–ª—é—á–∞–µ—Ç –∏ —Ç—É–Ω–Ω–µ–ª—å–Ω—É—é/–∫–∞—Ä–º–∞–Ω–Ω—É—é –∏–Ω—Ñ–µ–∫—Ü–∏—é —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ/ —Ç–æ—Ç–∞–ª—å–Ω–æ –∏–º–ø–ª–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–∞—Ç–µ—Ç–µ—Ä–∞."
            ),
            "–ò–ö –ü–í–ö (–±–µ–∑ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã—Å–µ–≤–∞ –∏–∑ –∫—Ä–æ–≤–∏)": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: \n"
                "1. –ö–∞—Ç–µ—Ç–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –±–æ–ª–µ–µ 48 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥.\n"
                "–ò\n"
                "2. –ì–Ω–æ–π/–≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ –≤ —Ä–∞–Ω–µ –≤—Ö–æ–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞. \n"
                "–ò \n"
                "3. –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å–µ–≤ –ü–í–ö ‚â• 10*3 –ö–û–ï/–º–ª –∏–ª–∏ –ø–æ–ª—É–∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å–µ–≤ –ü–í–ö > 15 –ö–û–ï. "
            ),
            "–ì–µ–Ω–µ—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ò–ö, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –¶–í–ö (–±–µ–∑ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã—Å–µ–≤–∞ –∏–∑ –∫—Ä–æ–≤–∏)": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º:\n"
                "1. –ö–∞—Ç–µ—Ç–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –±–æ–ª–µ–µ 48 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥. \n"
                "–ò\n"
                "2. –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å–µ–≤ –¶–í–ö ‚â• 10*3 –ö–û–ï/–º–ª –∏–ª–∏ –ø–æ–ª—É–∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å–µ–≤ –¶–í–ö > 15 –ö–û–ï. \n"
                "–ò\n"
                "3. –£–ª—É—á—à–µ–Ω–∏–µ –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—Ç–∏–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞."
            ),
            "–ì–µ–Ω–µ—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ò–ö, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –ü–í–ö (–±–µ–∑ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã—Å–µ–≤–∞ –∏–∑ –∫—Ä–æ–≤–∏)": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: \n"
                "1. –ö–∞—Ç–µ—Ç–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –±–æ–ª–µ–µ 48 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥.\n"
                "–ò\n"
                "2. –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å–µ–≤ –ü–í–ö ‚â• 10*3 –ö–û–ï/–º–ª –∏–ª–∏ –ø–æ–ª—É–∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å–µ–≤ –ü–í–ö > 15 –ö–û–ï. \n"
                "–ò\n"
                "3. —É–ª—É—á—à–µ–Ω–∏–µ –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—Ç–∏–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞."
            ),
            "–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –¶–í–ö": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: \n"
                "1. –ò–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞, –≤–æ–∑–Ω–∏–∫—à–∞—è –∑–∞ 48 —á–∞—Å–æ–≤ –¥–æ –∏–ª–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞, \n"
                "–ò\n"
                "2. –ü–∞—Ü–∏–µ–Ω—Ç –∏–º–µ–µ—Ç —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞ –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º–æ–≥–æ –º–µ—Ç–æ–¥–∞ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è):\n"
                "‚Ä¢ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞ –∏–∑ –∫—Ä–æ–≤–∏ –∏ –∏–∑ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∫–∞—Ç–µ—Ç–µ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –ø–æ—Å–µ–≤–∞ –¶–í–ö 10*3 –ö–û–ï/–º–ª –∏–ª–∏ –ø–æ–ª—É–∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –ø–æ—Å–µ–≤–∞ –¶–í–ö > 15 –ö–û–ï;\n"
                "‚Ä¢ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º–∏–∫—Ä–æ–±–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞ –≤ –æ–±—Ä–∞–∑—Ü–∞—Ö –∫—Ä–æ–≤–∏, –≤–∑—è—Ç—ã—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑ –¶–í–ö –∏ –∏–∑ –ø–µ—Ä–∏—Ñ–µ—Ä–∏—á–µ—Å–∫–æ–π –≤–µ–Ω—ã > 5*;\n"
                "‚Ä¢ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ—Å–µ–≤–∞ –∫—Ä–æ–≤–∏: –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–±—ã –∫—Ä–æ–≤–∏ –∏–∑ –¶–í–ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è —Ä–∞–Ω–µ–µ –Ω–∞ –¥–≤–∞ –∏–ª–∏ –±–æ–ª–µ–µ —á–∞—Å–∞ –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø—Ä–æ–±—ã –∫—Ä–æ–≤–∏ –∏–∑ –ø–µ—Ä–∏—Ñ–µ—Ä–∏—á–µ—Å–∫–æ–π –≤–µ–Ω—ã (–æ–±—Ä–∞–∑—Ü—ã –∫—Ä–æ–≤–∏ –±–µ—Ä—É—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)*. \n"
                "–ò\n"
                "3. –í—ã–¥–µ–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞ –∏–∑ –∫—Ä–æ–≤–∏ –∏ –∏–∑ –æ—Ç–¥–µ–ª—è–µ–º–æ–≥–æ –∏–∑ —Ä–∞–Ω—ã –≤—Ö–æ–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞ (–≤ —Å–ª—É—á–∞–µ –µ–≥–æ –Ω–∞–ª–∏—á–∏—è –∏ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –º–µ—Å—Ç–Ω—É—é –∏–Ω—Ñ–µ–∫—Ü–∏—é)\n\n"
                "–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: * –î–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –∫—Ä–æ–≤–æ—Ç–æ–∫–∞, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å –¶–í–ö, –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –º–µ—Ç–æ–¥–∞–º, –Ω–µ —Ç—Ä–µ–±—É—é—â–∏–º —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞. –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –Ω–µ—Ç –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–¥–∞–ª–∏—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Å–æ—Å—É–¥–∏—Å—Ç—ã–π –∫–∞—Ç–µ—Ç–µ—Ä –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –µ–≥–æ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏."
            ),
            "–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –ü–í–ö": (
                "–î–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: \n"
                "1. –ò–Ω—Ñ–µ–∫—Ü–∏—è –∫—Ä–æ–≤–æ—Ç–æ–∫–∞, –≤–æ–∑–Ω–∏–∫—à–∞—è –∑–∞ 48 —á–∞—Å–æ–≤ –¥–æ –∏–ª–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞.\n"
                "–ò \n"
                "2. –í—ã–¥–µ–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞ –∏–∑ –∫—Ä–æ–≤–∏ –∏ –∏–∑ –∫–∞—Ç–µ—Ç–µ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –ø–æ—Å–µ–≤–∞ –¶–í–ö 10*3 –ö–û–ï/–º–ª –∏–ª–∏ –ø–æ–ª—É–∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –ø–æ—Å–µ–≤–∞ –¶–í–ö > 15 –ö–û–ï. \n"
                "–ò–õ–ò \n"
                "3. –í—ã–¥–µ–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–∞ –∏–∑ –∫—Ä–æ–≤–∏ –∏ –∏–∑ –æ—Ç–¥–µ–ª—è–µ–º–æ–≥–æ –∏–∑ —Ä–∞–Ω—ã –≤—Ö–æ–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è –∫–∞—Ç–µ—Ç–µ—Ä–∞ (–≤ —Å–ª—É—á–∞–∏ –µ–≥–æ –Ω–∞–ª–∏—á–∏—è)."
            )
        }
        ReplyKeyboardMarkup(build_menu(IK_TYPES_MENU), resize_keyboard=True)


# === –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –±–æ–ª—å–Ω–æ–≥–æ (—Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏) ===
    if stack[-1] == "infect_menu":
        link_map = {
            "–ü–µ—Ä–≤–∏—á–Ω—ã–µ –ø—Ä–æ—Ç–∏–≤–æ—ç–ø–∏–¥–µ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è": "https://disk.yandex.ru/i/s52xCqt_eZicCQ",
            "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –í–ò–ß-–∏–Ω—Ñ–µ–∫—Ü–∏–∏ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞": "https://disk.yandex.ru/i/MRp6KIj7zEhPuw",
            "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –≥–µ–ø–∞—Ç–∏—Ç–∞ –í –∏ –° —É –ø–∞—Ü–∏–µ–Ω—Ç–∞": "https://disk.yandex.ru/i/8RQRRNAMmrxqfA",
            "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—É–±–µ—Ä–∫—É–ª–µ–∑–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞": "https://disk.yandex.ru/i/qK-O_HfyAKIWgw",
            "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è —Å–∞–ª—å–º–æ–Ω–µ–ª–ª–µ–∑–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞": "https://disk.yandex.ru/i/xzvSV4e0LIK7OQ",
            "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –ì–µ–ø–∞—Ç–∏—Ç–∞ –ê –∏ –ï": "https://disk.yandex.ru/i/zeZC8_IBi-LlSw",
            "–ü—Ä–æ—Ç–∏–≤–æ—ç–ø–∏–¥–µ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø—Ä–æ—Ç–∏–≤ –ì—Ä–∏–ø–ø, –û–†–í–ò, Covid-19": "https://disk.yandex.ru/i/kaD1_OMYU53XTA",
            "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –∫–æ—Ä–∏, –∫—Ä–∞—Å–Ω—É—Ö–∏, —ç–ø–∏–¥–ø–∞—Ä–æ—Ç–∏—Ç–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞": "https://disk.yandex.ru/i/ekx5SOiq7B48ng",
            "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –∫–æ–∫–ª—é—à–∞ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞": "https://disk.yandex.ru/i/OiWzoU_SFpcFaw",
            "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –¥–∏—Ñ—Ç–µ—Ä–∏–∏ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞": "https://disk.yandex.ru/i/yDhq-ppTSgbC5Q",
            "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –º–µ–Ω–∏–Ω–≥–æ–∫–æ–∫–∫–æ–≤–æ–π –∏–Ω—Ñ–µ–∫—Ü–∏–∏": "https://disk.yandex.ru/i/J1z98NuOvt23mg",
            "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–Ω–µ–≤–º–æ–Ω–∏–∏ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞": "https://disk.yandex.ru/i/lxszApbrFfSjSg",
            "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–µ–ø—Ç–æ–∫–æ–∫–∫–æ–≤–æ–π –∏–Ω—Ñ–µ–∫—Ü–∏–∏ –≥—Ä—É–ø–ø—ã –ê —É –ø–∞—Ü–∏–µ–Ω—Ç–∞": "https://disk.yandex.ru/i/4Zkp_KK3GJr6Fw",
            "–î–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –ª–µ–≥–∏–æ–Ω–µ–ª–ª–µ–∑–∞": "https://disk.yandex.ru/i/VMtdtyH1GlGgvQ",
            "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –≥–Ω–æ–π–Ω–æ-–≤–æ—Å–ø–∞–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π": "https://disk.yandex.ru/i/nCHBXX63VtqbeA",
        }
        if text in link_map:
            await update.message.reply_text(f"üìé {text}:\n{link_map[text]}")
        else:
            await update.message.reply_text("–ü—É–Ω–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.")

        mk = ReplyKeyboardMarkup(build_menu(INFECT_MENU), resize_keyboard=True)
        await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ñ–µ–∫—Ü–∏–∏:", reply_markup=mk)
        return

    # === –ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ===
    if stack[-1] == "mm_menu":
        if text == "–ì—Ä—É–ø–ø—ã –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ (–ø–∞—Ü–∏–µ–Ω—Ç—ã)":
            stack.append("mm_group_mo")
            mk = ReplyKeyboardMarkup(build_menu(MM_GROUP_MO_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–¥:", reply_markup=mk)
        elif text == "–í–∏–¥ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ (–ø–∞—Ü–∏–µ–Ω—Ç—ã)":
            stack.append("mm_species_mo")
            mk = ReplyKeyboardMarkup(build_menu(MM_SPECIES_MO_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–¥:", reply_markup=mk)
        elif text == "–ü—Ä–æ—Ñ–∏–ª–∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤":
            stack.append("mm_resist")
            mk = ReplyKeyboardMarkup(build_menu(MM_RESIST_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–¥:", reply_markup=mk)
        elif text == "–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã":
            msg = (
                "1) –°–∞–Ω–ü–∏–ù 3.3686-21 ¬´–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π¬ª\n"
                "2) –ú–† 3.1.0346-24 ¬´–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è—Ö¬ª\n"
                "3) –ò-–ü–õ–ù–ê-–†–ù-–°–¢-2024-11-1 ¬´–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –æ –ø–æ—Ä—è–¥–∫–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞¬ª\n"
                "4) –ò-022-–†–ù-–°–¢ ¬´–û –ø–æ—Ä—è–¥–∫–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏¬ª"
            )
            mk = ReplyKeyboardMarkup(build_menu(MM_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        elif text == "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å":
            await update.message.reply_document(document="https://disk.yandex.ru/i/g59PyXf3ywDUNA")
            mk = ReplyKeyboardMarkup(build_menu(MM_MENU), resize_keyboard=True)
            await update.message.reply_text("–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:", reply_markup=mk)
        elif text == "–ü–µ—Ä–µ—á–µ–Ω—å –±–∏–æ–º–∞—Ç–µ—Ä–∏–∞–ª–∞ –¥–ª—è –ø–ª–∞–Ω–æ–≤–æ–≥–æ –º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/jIiEJ_eI0OGuLw")
            mk = ReplyKeyboardMarkup(build_menu(MM_MENU), resize_keyboard=True)
            await update.message.reply_text("–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:", reply_markup=mk)
        elif text == "–ì–æ–¥–æ–≤–æ–π –æ—Ç—á–µ—Ç –ú–ú":
            await update.message.reply_document(document="https://disk.yandex.ru/i/FNVqv_PrXK13vw")
            mk = ReplyKeyboardMarkup(build_menu(MM_MENU), resize_keyboard=True)
            await update.message.reply_text("–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:", reply_markup=mk)
        elif text == "–û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–µ–∑–∏–Ω—Ñ–∏—Ü–∏—Ä—É—é—â–∏—Ö —Å—Ä–µ–¥—Å—Ç–≤":
            msg = (
                "–ù–∞ 11.08.2025 –≥–æ–¥–∞ –±—ã–ª–∞ –æ—Ü–µ–Ω–µ–Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–µ–∑–∏–Ω—Ñ–∏—Ü–∏—Ä—É—é—â–µ–≥–æ —Ä–∞—Å—Ç–≤–æ—Ä–∞ ¬´–ê–∫—Ç–æ—Å–µ–¥ –ø–ª—é—Å¬ª 0,5% –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ Ps. Aeruginosa, Ac. Baumanii, Kl.pneumoniae (–ø–∞–Ω—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è).\n"
                "–†–µ–∑—É–ª—å—Ç–∞—Ç- –®—Ç–∞–º–º—ã Ps. Aeruginosa, Ac. Baumanii, Kl.pneumoniae (–ø–∞–Ω—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è) —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ –¥–µ–π—Å—Ç–≤–∏—é –¥–µ–∑—Å—Ä–µ–¥—Å—Ç–≤–∞ ¬´–ê–∫—Ç–æ—Å–µ–¥ –ø–ª—é—Å¬ª –Ω–∞ 100%"
            )
            mk = ReplyKeyboardMarkup(build_menu(MM_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        elif text == "–ß–∞—Å—Ç–æ—Ç–∞ ESCAPE-–ø–∞—Ç–æ–≥–µ–Ω–æ–≤":
            stack.append("mm_escape")
            mk = ReplyKeyboardMarkup(build_menu(MM_ESCAPE_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–¥:", reply_markup=mk)
        elif text == "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–∏–∫—Ä–æ–±–Ω–æ–≥–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/WBqa9WOXvGbZJg")
            mk = ReplyKeyboardMarkup(build_menu(MM_MENU), resize_keyboard=True)
            await update.message.reply_text("–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:", reply_markup=mk)
        elif text == "–ü–∞—Ü–∏–µ–Ω—Ç—ã —Å –ø–æ–ª–∏—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º–∏ —à—Ç–∞–º–º–∞–º–∏":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/bxAj63ypzyTvQg")
            mk = ReplyKeyboardMarkup(build_menu(MM_MENU), resize_keyboard=True)
            await update.message.reply_text("–ú–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:", reply_markup=mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(MM_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—É–Ω–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.", reply_markup=mk)
        return

    # === –ì—Ä—É–ø–ø—ã –ú–û ===
    if stack[-1] == "mm_group_mo":
        if text == "2024 –≥–æ–¥ –≥—Ä—É–ø–ø—ã –ú–û":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/-M7amcn-2X3Elg")
        elif text == "2025 –≥–æ–¥ –≥—Ä—É–ø–ø—ã –ú–û":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/CaQLYpnF_0LNYg")
        mk = ReplyKeyboardMarkup(build_menu(MM_GROUP_MO_MENU), resize_keyboard=True)
        await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–¥:", reply_markup=mk)
        return

    # === –í–∏–¥ –ú–û ===
    if stack[-1] == "mm_species_mo":
        if text == "2024 –≥–æ–¥ –≤–∏–¥ –ú–û":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/WWIGB7MKm7gzsg")
        elif text == "2025 –≥–æ–¥ –≤–∏–¥ –ú–û":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/CaQLYpnF_0LNYg")
        mk = ReplyKeyboardMarkup(build_menu(MM_SPECIES_MO_MENU), resize_keyboard=True)
        await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–¥:", reply_markup=mk)
        return

    # === –ü—Ä–æ—Ñ–∏–ª–∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ ===
    if stack[-1] == "mm_resist":
        if text == "2024 –ø—Ä —Ä–µ–∑–∏—Å—Ç":
            link = "https://disk.yandex.ru/i/0bnwY1XiGqPXcA"
            await update.message.reply_text(f"üìÑ –ü—Ä–æ—Ñ–∏–ª–∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∑–∞ 2024 –≥.:\n{link}")
        elif text == "2025 –ø—Ä —Ä–µ–∑–∏—Å—Ç":
            link = "https://disk.yandex.ru/i/2Da4WudpqRGhZQ"
            await update.message.reply_text(f"üìÑ –ü—Ä–æ—Ñ–∏–ª–∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∑–∞ 2025 –≥.:\n{link}")
        return

    # === ESCAPE-–ø–∞—Ç–æ–≥–µ–Ω—ã ===
    if stack[-1] == "mm_escape":
        if text == "2024 Escape":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/urX5sUQJ_qAIag")
        elif text == "2025 Escape":
            await update.message.reply_text("–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –¥–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ 16.01.2026")
        mk = ReplyKeyboardMarkup(build_menu(MM_ESCAPE_MENU), resize_keyboard=True)
        await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–¥:", reply_markup=mk)
        return
    # === –ê–≤–∞—Ä–∏–π–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ ===
    if stack[-1] == "as_menu":
        if text == "–ê–ª–≥–æ—Ä–∏—Ç–º –º–µ—Ä –ª–∏—á–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/rbVJMXp8NoAtdA")
        elif text == "–ê–ª–≥–æ—Ä–∏—Ç–º —É—á–µ—Ç–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–≤–∞—Ä–∏–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π":
            link = "https://disk.yandex.ru/i/_aruvxBoI8v2Vg"
            await update.message.reply_text(f"üìÑ –ê–ª–≥–æ—Ä–∏—Ç–º —É—á–µ—Ç–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–≤–∞—Ä–∏–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π:\n{link}")
        elif text == "–°–æ—Å—Ç–∞–≤ —É–∫–ª–∞–¥–∫–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –ø–∞—Ä–µ–Ω—Ç–µ—Ä–∞–ª—å–Ω—ã—Ö –∏–Ω—Ñ–µ–∫—Ü–∏–π":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/LMnm078f1DxFGA")
        elif text == "–î–æ—Ç–µ—Å—Ç–æ–≤–æ–µ –∏ –ø–æ—Å–ª–µ—Ç–µ—Å—Ç–æ–≤–æ–µ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —ç–∫—Å–ø—Ä–µ—Å—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–∞ –í–ò–ß-–∏–Ω—Ñ–µ–∫—Ü–∏—é":
            stack.append("as_consult")
            mk = ReplyKeyboardMarkup(build_menu(AS_CONSULT_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:", reply_markup=mk)
            return
        elif text == "–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –í–ò–ß-–∏–Ω—Ñ–µ–∫—Ü–∏—é":
            link = "https://disk.yandex.ru/i/rQc09SM2SO7Ydg"
            await update.message.reply_text(f"üìÑ –ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –í–ò–ß:\n{link}")
        elif text == "–ñ—É—Ä–Ω–∞–ª —É—á–µ—Ç–∞ –∞–≤–∞—Ä–∏–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π":
            link = "https://disk.yandex.ru/i/0k83VIDOZ52VQw"
            await update.message.reply_text(f"üìÑ –ñ—É—Ä–Ω–∞–ª —É—á–µ—Ç–∞ –∞–≤–∞—Ä–∏–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π:\n{link}")
        elif text == "–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø–æ —Å–Ω–∏–∂–µ–Ω–∏—é —á–∏—Å–ª–∞ –ê–°":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/mh_Z6sMi4yVGEA")
        else:
            mk = ReplyKeyboardMarkup(build_menu(AS_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—É–Ω–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.", reply_markup=mk)
            return

        # –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ ‚Äî –≤–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é –∞–≤–∞—Ä–∏–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π
        mk = ReplyKeyboardMarkup(build_menu(AS_MENU), resize_keyboard=True)
        await update.message.reply_text("–ê–≤–∞—Ä–∏–π–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏:", reply_markup=mk)
        return

    # === –ö–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –í–ò–ß ===
    if stack[-1] == "as_consult":
        consult_map = {
            "–î–æ—Ç–µ—Å—Ç–æ–≤–æ–µ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ": "https://disk.yandex.ru/i/SIeQBF9hGum-xw",
            "–ü–æ—Å–ª–µ—Ç–µ—Å—Ç–æ–≤–æ–µ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ": "https://disk.yandex.ru/i/X2RxxiNSrWlmbw",
            "–°—Ö–µ–º–∞ –ø–æ—Å–ª–µ—Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ": "https://disk.yandex.ru/i/VnxGAc1PIURY2w",
            "–°—Ö–µ–º–∞ –ø–æ—Å–ª–µ—Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ": "https://disk.yandex.ru/i/a_4hZGf0BheXHg"
        }
        if text in consult_map:
            await update.message.reply_photo(photo=consult_map[text])
        else:
            mk = ReplyKeyboardMarkup(build_menu(AS_CONSULT_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:", reply_markup=mk)
            return

        mk = ReplyKeyboardMarkup(build_menu(AS_CONSULT_MENU), resize_keyboard=True)
        await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:", reply_markup=mk)
        return

    # === –û–û–ò: –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ===
    if stack[-1] == "oOI_menu":
        if text == "–ü—Ä–æ—Ç–∏–≤–æ—ç–ø–∏–¥–µ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è":
            stack.append("oOI_measures")
            mk = ReplyKeyboardMarkup(build_menu(OOI_MEASURES_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—Ä–æ—Ç–∏–≤–æ—ç–ø–∏–¥–µ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:", reply_markup=mk)
        elif text == "–°–ò–ó –¥–ª—è –û–û–ò":
            stack.append("oOI_ppe")
            mk = ReplyKeyboardMarkup(build_menu(OOI_PPE_MENU), resize_keyboard=True)
            await update.message.reply_text("–°–ò–ó –¥–ª—è –û–û–ò:", reply_markup=mk)
        elif text == "–õ–µ—á–µ–Ω–∏–µ –∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –ø—Ä–∏ –û–û–ò":
            stack.append("oOI_treatment")
            mk = ReplyKeyboardMarkup(build_menu(OOI_TREATMENT_MENU), resize_keyboard=True)
            await update.message.reply_text("–õ–µ—á–µ–Ω–∏–µ –∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞:", reply_markup=mk)
        elif text == "–ú–µ—Ä—ã –ª–∏—á–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤":
            stack.append("oOI_personal")
            mk = ReplyKeyboardMarkup(build_menu(OOI_PERSONAL_MENU), resize_keyboard=True)
            await update.message.reply_text("–ú–µ—Ä—ã –ª–∏—á–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏:", reply_markup=mk)
        elif text == "–ó–∞–±–æ—Ä –±–∏–æ–º–∞—Ç–µ—Ä–∏–∞–ª–∞ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –û–û–ò":
            link = "https://disk.yandex.ru/d/CndmqGbpp21uaA"
            await update.message.reply_text(f"üìÑ –ó–∞–±–æ—Ä –±–∏–æ–º–∞—Ç–µ—Ä–∏–∞–ª–∞ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –û–û–ò:\n{link}")
            mk = ReplyKeyboardMarkup(build_menu(OOI_MENU), resize_keyboard=True)
            await update.message.reply_text("–û—Å–æ–±–æ –æ–ø–∞—Å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏:", reply_markup=mk)
        elif text == "–†–µ–∂–∏–º—ã –æ–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π –ø—Ä–∏ –û–û–ò":
            stack.append("oOI_decont")
            mk = ReplyKeyboardMarkup(build_menu(OOI_DECONT_MENU), resize_keyboard=True)
            await update.message.reply_text("–†–µ–∂–∏–º—ã –æ–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏—è:", reply_markup=mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(OOI_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—É–Ω–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.", reply_markup=mk)
        return

    # === –û–û–ò: –ü—Ä–æ—Ç–∏–≤–æ—ç–ø–∏–¥–µ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è ===
    if stack[-1] == "oOI_measures":
        if text == "–û–±—â–∏–π –ø–ª–∞–Ω –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/rrQERzTebQHwvQ")
        elif text == "–ü–µ—Ä–≤–∏—á–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è":
            link = "https://disk.yandex.ru/i/ObKRV28B61xbxA"
            await update.message.reply_text(f"üìÑ –ü–µ—Ä–≤–∏—á–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:\n{link}")
        return

    # === –û–û–ò: –°–ò–ó –¥–ª—è –û–û–ò ===
    if stack[-1] == "oOI_ppe":
        if text == "–í–∏–¥—ã –∫–æ—Å—Ç—é–º–æ–≤":
            stack.append("oOI_ppe_types")
            mk = ReplyKeyboardMarkup(build_menu(OOI_PPE_TYPES_MENU), resize_keyboard=True)
            await update.message.reply_text("–í–∏–¥—ã –∫–æ—Å—Ç—é–º–æ–≤:", reply_markup=mk)
            return
        elif text == "–°–ª—É—á–∞–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ—Å—Ç—é–º–æ–≤":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/rSl9Io5s5wvjXw")
        elif text == "–ü–æ—Ä—è–¥–æ–∫ –Ω–∞–¥–µ–≤–∞–Ω–∏—è –∏ —Å–Ω—è—Ç–∏—è –∫–æ—Å—Ç—é–º–∞ ¬´1 —Ç–∏–ø–∞¬ª":
            link = "https://disk.yandex.ru/i/oXbLPciTOuxXbA"
            await update.message.reply_text(f"üìπ –ü–æ—Ä—è–¥–æ–∫ –Ω–∞–¥–µ–≤–∞–Ω–∏—è –∏ —Å–Ω—è—Ç–∏—è –∫–æ—Å—Ç—é–º–∞ ¬´1 —Ç–∏–ø–∞¬ª:\n{link}")
        elif text == "–ü–æ—Ä—è–¥–æ–∫ –Ω–∞–¥–µ–≤–∞–Ω–∏—è –∏ —Å–Ω—è—Ç–∏—è ¬´–ö–≤–∞—Ä—Ü-–ú1¬ª":
            link = "https://disk.yandex.ru/i/ZVOyGYdfU9R_pw"
            await update.message.reply_text(f"üìπ –ü–æ—Ä—è–¥–æ–∫ –Ω–∞–¥–µ–≤–∞–Ω–∏—è –∏ —Å–Ω—è—Ç–∏—è ¬´–ö–≤–∞—Ä—Ü-–ú1¬ª:\n{link}")
        mk = ReplyKeyboardMarkup(build_menu(OOI_PPE_MENU), resize_keyboard=True)
        await update.message.reply_text("–°–ò–ó –¥–ª—è –û–û–ò:", reply_markup=mk)
        return

    # === –û–û–ò: –í–∏–¥—ã –∫–æ—Å—Ç—é–º–æ–≤ ===
    if stack[-1] == "oOI_ppe_types":
        costume_images = {
            "–ö–æ—Å—Ç—é–º 1 —Ç–∏–ø–∞": "https://disk.yandex.ru/i/8xxF32G8oFKTwQ",
            "–ö–æ—Å—Ç—é–º 2 —Ç–∏–ø–∞": "https://disk.yandex.ru/i/zxVzw1sN2SrxkA",
            "–ö–æ—Å—Ç—é–º 3 —Ç–∏–ø–∞": "https://disk.yandex.ru/i/XENHeLAwPFpN_w",
            "–ö–æ—Å—Ç—é–º 4 —Ç–∏–ø–∞": "https://disk.yandex.ru/i/04kYBend1FNo2Q",
            "–ö–æ—Å—Ç—é–º –ö–≤–∞—Ä—Ü-–ú1": "https://disk.yandex.ru/i/uwgHGfIPR14YoA",
        }
        if text in costume_images:
            await update.message.reply_photo(photo=costume_images[text])
        mk = ReplyKeyboardMarkup(build_menu(OOI_PPE_TYPES_MENU), resize_keyboard=True)
        await update.message.reply_text("–í–∏–¥—ã –∫–æ—Å—Ç—é–º–æ–≤:", reply_markup=mk)
        return

    # === –û–û–ò: –õ–µ—á–µ–Ω–∏–µ –∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ ===
    if stack[-1] == "oOI_treatment":
        treatment_images = {
            "–°—Ö–µ–º–∞ —Ç–µ—Ä–∞–ø–∏–∏ –±–æ–ª—å–Ω—ã—Ö –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏": "https://disk.yandex.ru/i/c5BJ1RzfzTm7Xw",
            "–°—Ö–µ–º–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –ø—Ä–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–º –≤–æ–∑–±—É–¥–∏—Ç–µ–ª–µ": "https://disk.yandex.ru/i/brdDSQlJrGdHQw",
            "–ß—É–º–∞": "https://disk.yandex.ru/i/nIAaqMwANXenRg",
            "–•–æ–ª–µ—Ä–∞": "https://disk.yandex.ru/i/AZeP_WsXb1cWyA",
            "–ü–∞—Ç–æ–≥–µ–Ω–Ω—ã–π –≥—Ä–∏–ø–ø": "https://disk.yandex.ru/i/5AuOnhIS6p4NTA",
            "–¢—Ä–æ–ø–∏—á–µ—Å–∫–∞—è –º–∞–ª—è—Ä–∏—è": "https://disk.yandex.ru/i/vDaIXr7VGjG2Lw",
            "–õ–∏—Ö–æ—Ä–∞–¥–∫–∞ –†–∏—Ñ—Ç-–í–∞–ª–ª–∏": "https://disk.yandex.ru/i/5vJ6__AZludE6g",
            "–ú–µ–Ω–∏–Ω–≥–æ–∫–æ–∫–∫–æ–≤–∞—è –±–æ–ª–µ–∑–Ω—å": "https://disk.yandex.ru/i/NRcF0SrH74EKYQ",
        }
        if text in treatment_images:
            await update.message.reply_photo(photo=treatment_images[text])
        mk = ReplyKeyboardMarkup(build_menu(OOI_TREATMENT_MENU), resize_keyboard=True)
        await update.message.reply_text("–õ–µ—á–µ–Ω–∏–µ –∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞:", reply_markup=mk)
        return

    # === –û–û–ò: –ú–µ—Ä—ã –ª–∏—á–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ ===
    if stack[-1] == "oOI_personal":
        if text == "–ú–µ—Ä—ã":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/eL6x615eHTLGQw")
        elif text == "–£–∫–ª–∞–¥–∫–∞ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –û–û–ò":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/3kEDdz-r3fDcBw")
        mk = ReplyKeyboardMarkup(build_menu(OOI_PERSONAL_MENU), resize_keyboard=True)
        await update.message.reply_text("–ú–µ—Ä—ã –ª–∏—á–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏:", reply_markup=mk)
        return

    # === –û–û–ò: –†–µ–∂–∏–º—ã –æ–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏—è ===
    if stack[-1] == "oOI_decont":
        decont_images = {
            "–•–æ–ª–µ—Ä–∞": "https://disk.yandex.ru/i/peO08GEA0LRpiA",
            "–ß—É–º–∞": "https://disk.yandex.ru/i/djaYsTSyuj7MzA",
            "–°–∏–±–∏—Ä—Å–∫–∞—è —è–∑–≤–∞": "https://disk.yandex.ru/i/r14qWfOdwiOpSg",
            "–§–µ–∫–∞–ª–∏–∏, –º–æ–∫—Ä–æ—Ç–∞, —Å—ã–≤–æ—Ä–æ—Ç–∫–∞ –∫—Ä–æ–≤–∏": "https://disk.yandex.ru/i/jurg6nsQibLtGA",
            "–í–∏—Ä—É—Å–Ω—ã–µ –∏–Ω—Ñ–µ–∫—Ü–∏–∏": "https://disk.yandex.ru/i/lmVpT4cZVXPuRA",
            "–ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ç–≤–æ—Ä–∞ ¬´–•–ª–æ—Ä–∞–ø–∏–Ω¬ª": "https://disk.yandex.ru/i/jIIPqqzj2cE9Rg",
        }
        if text in decont_images:
            await update.message.reply_photo(photo=decont_images[text])
        mk = ReplyKeyboardMarkup(build_menu(OOI_DECONT_MENU), resize_keyboard=True)
        await update.message.reply_text("–†–µ–∂–∏–º—ã –æ–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏—è:", reply_markup=mk)
        return

    # === –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢: –≤—ã–±–æ—Ä –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è ===
    if stack[-1] == "amt_menu":
        if text in AMT_IMAGES:
            stack.append(f"amt_{text}")
            if text == "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–æ–≤ –±—Ä—é—à–Ω–æ–π –ø–æ–ª–æ—Å—Ç–∏":
                mk = ReplyKeyboardMarkup(build_menu(AMT_ABD_MENU), resize_keyboard=True)
                await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:", reply_markup=mk)
            else:
                mk = ReplyKeyboardMarkup(build_menu(AMT_SUBMENU), resize_keyboard=True)
                await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:", reply_markup=mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(AMT_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—É–Ω–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.", reply_markup=mk)
        return

    # === –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢: –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ===
    if stack[-1].startswith("amt_"):
        disease = stack[-1][4:]  # —É–±–∏—Ä–∞–µ–º "amt_"
        if disease in AMT_IMAGES and text in AMT_IMAGES[disease]:
            photo_url = AMT_IMAGES[disease][text]
            await update.message.reply_photo(photo=photo_url, caption=f"{disease} ‚Äî {text}")
        # –í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
        mk = ReplyKeyboardMarkup(build_menu(AMT_MENU), resize_keyboard=True)
        await update.message.reply_text("–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢:", reply_markup=mk)
        return
    # === –ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫ ===
    if stack[-1] == "hand_hygiene":
        if text == "–í–≤–µ–¥–µ–Ω–∏–µ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–∏–≥–∏–µ–Ω—ã —Ä—É–∫":
            msg = (
                "–ü–æ—á–µ–º—É –≥–∏–≥–∏–µ–Ω–∞ —Ä—É–∫ ‚Äî –æ—Å–Ω–æ–≤–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏ (–ò–°–ú–ü)\n\n"
                "–ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫ —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º–æ–π –ø—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –º–µ—Ä–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –ò–°–ú–ü. \n"
                "–†—É–∫–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ ‚Äî –æ–¥–∏–Ω –∏–∑ –≥–ª–∞–≤–Ω—ã—Ö –ø—É—Ç–µ–π –ø–µ—Ä–µ–¥–∞—á–∏ –ø–∞—Ç–æ–≥–µ–Ω–Ω—ã—Ö –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ –º–µ–∂–¥—É –ø–∞—Ü–∏–µ–Ω—Ç–∞–º–∏, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º –∏ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥–æ–π. –î–∞–∂–µ –ø—Ä–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ —á–∏—Å—Ç–æ–π –∫–æ–∂–µ –Ω–∞ —Ä—É–∫–∞—Ö –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –±–æ–ª–µ–∑–Ω–µ—Ç–≤–æ—Ä–Ω—ã–µ –±–∞–∫—Ç–µ—Ä–∏–∏ (–≤–∫–ª—é—á–∞—è Staphylococcus aureus, Escherichia coli, Clostridioides difficile, –∞ —Ç–∞–∫–∂–µ –º—É–ª—å—Ç–∏—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ —à—Ç–∞–º–º—ã), –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–≥–∫–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø—Ä–∏ –∫–æ–Ω—Ç–∞–∫—Ç–µ.\n\n"
                "–°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–∏–≥–∏–µ–Ω–∞ —Ä—É–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç:\n"
                "‚óè —Å–Ω–∏–∑–∏—Ç—å —Ä–∏—Å–∫ –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–π –æ—Ç –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∫ –ø–∞—Ü–∏–µ–Ω—Ç—É;\n"
                "‚óè –∑–∞—â–∏—Ç–∏—Ç—å —Å–∞–º–æ–≥–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞;\n"
                "‚óè –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –≤—Å–ø—ã—à–∫–∏ –≤–Ω—É—Ç—Ä–∏–±–æ–ª—å–Ω–∏—á–Ω—ã—Ö –∏–Ω—Ñ–µ–∫—Ü–∏–π;\n"
                "‚óè —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ–≤ –∏ –∑–∞–º–µ–¥–ª–∏—Ç—å —Ä–∞–∑–≤–∏—Ç–∏–µ –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.\n\n"
                "–í—Å–µ–º–∏—Ä–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–í–û–ó) –Ω–∞–∑—ã–≤–∞–µ—Ç –≥–∏–≥–∏–µ–Ω—É —Ä—É–∫ ¬´–∑–æ–ª–æ—Ç—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º¬ª –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏."
            )
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        elif text == "–ü—è—Ç—å –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –≥–∏–≥–∏–µ–Ω—ã —Ä—É–∫ (–ø–æ –í–û–ó)":
            msg = (
                "‚óè –ü–µ—Ä–µ–¥ –∫–æ–Ω—Ç–∞–∫—Ç–æ–º —Å –ø–∞—Ü–∏–µ–Ω—Ç–æ–º\n"
                "‚óè –ü–µ—Ä–µ–¥ —á–∏—Å—Ç–æ–π/–∞—Å–µ–ø—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä–æ–π\n"
                "‚óè –ü–æ—Å–ª–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ –∂–∏–¥–∫–æ—Å—Ç—è–º–∏\n"
                "‚óè –ü–æ—Å–ª–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å –ø–∞—Ü–∏–µ–Ω—Ç–æ–º\n"
                "‚óè –ü–æ—Å–ª–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å –æ–∫—Ä—É–∂–∞—é—â–µ–π –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å—Ä–µ–¥–æ–π"
            )
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await update.message.reply_text(msg, reply_markup=mk)
        elif text == "–ú–µ—Ç–æ–¥–∏–∫–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∏ –≥–∏–≥–∏–µ–Ω—ã —Ä—É–∫":
            stack.append("hand_techniques")
            mk = ReplyKeyboardMarkup(build_menu(HAND_TECHNIQUES_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–æ–¥–∏–∫—É:", reply_markup=mk)
            return
        elif text == "–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤–∞—è –±–∞–∑–∞":
            msg = (
                "1) –ú–£ 3.5.1.3674-20 \"–û–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏–µ —Ä—É–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –∏ –∫–æ–∂–Ω—ã—Ö –ø–æ–∫—Ä–æ–≤–æ–≤ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –æ–∫–∞–∑–∞–Ω–∏–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏\"\n"
                "2) –°–∞–Ω–ü–∏–ù 3.3686-21 \"–°–∞–Ω–∏—Ç–∞—Ä–Ω–æ-—ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–µ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã—Ö –±–æ–ª–µ–∑–Ω–µ–π\"\n"
                "3) –°–û–ü-044-–†–ù-–°–¢ \"–ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫\"\n"
                "4) –°–û–ü-045-–†–ù-–°–¢ \"–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫\""
            )
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await update.message.reply_text(msg, reply_markup=mk)
        elif text == "–û–±—É—á–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å":
            await update.message.reply_photo(photo="https://disk.yandex.ru/i/7JGcNBmtUmwJDg")
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await update.message.reply_text("–ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫:", reply_markup=mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—É–Ω–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.", reply_markup=mk)
        return

    # === –ú–µ—Ç–æ–¥–∏–∫–∏ –≥–∏–≥–∏–µ–Ω—ã —Ä—É–∫ ===
    if stack[-1] == "hand_techniques":
        if text == "–ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫ —Å –º—ã–ª–æ–º –∏ –≤–æ–¥–æ–π / –∞–Ω—Ç–∏—Å–µ–ø—Ç–∏–∫–æ–º":
            await update.message.reply_text("üìπ –ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫:\nhttps://disk.yandex.ru/i/K11JJQeKtHdrZA")
        elif text == "–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫":
            await update.message.reply_text("üìπ –•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫:\nhttps://disk.yandex.ru/i/PvnWfDPJYpDmIQ")
        else:
            mk = ReplyKeyboardMarkup(build_menu(HAND_TECHNIQUES_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–æ–¥–∏–∫—É:", reply_markup=mk)
            return
        # –í–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é –º–µ—Ç–æ–¥–∏–∫ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–∏–¥–µ–æ
        mk = ReplyKeyboardMarkup(build_menu(HAND_TECHNIQUES_MENU), resize_keyboard=True)
        await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–æ–¥–∏–∫—É:", reply_markup=mk)
        return

    # === –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢ ===
    if stack[-1] == "amt_menu":
        AMT_LINKS = {
            "–ò–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–π —ç–Ω–¥–æ–∫–∞—Ä–¥–∏—Ç": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/cOR6sTVnyGIDqQ",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/sA58zTvNdLFWkg",
            },
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –∫–æ–∂–∏ –∏ –º—è–≥–∫–∏—Ö —Ç–∫–∞–Ω–µ–π": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/o8z1AHFnmVZqUg",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/26jcg2fv6Craqw",
            },
            "–≠–Ω—Ç–µ—Ä–æ–∫–æ–ª–∏—Ç, –≤—ã–∑–≤–∞–Ω–Ω—ã–π Clostridioides difficille": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/g5gqxtFQRme4rA",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/xk-HSXwQqYz-ZA",
            },
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–æ–≤ –±—Ä—é—à–Ω–æ–π –ø–æ–ª–æ—Å—Ç–∏": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/yFJ8nMl9iy_TGw",
                "–≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è —Ç–µ—Ä–∞–ø–∏—è –∏–Ω–≤–∞–∑–∏–≤–Ω–æ–≥–æ –º–∏–∫–æ–∑–∞": "https://disk.yandex.ru/i/_unH6TWjt8FRHg",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/hOk8WzAo8xvAGA",
            },
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –º–æ—á–µ–≤—ã–≤–æ–¥—è—â–∏—Ö –ø—É—Ç–µ–π": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/gX1wgTfwGjwzvQ",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/GJqNTd6EMpAacw",
            },
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–æ–≤ –º–∞–ª–æ–≥–æ —Ç–∞–∑–∞": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/QyIlmnkK5UBqTA",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/fSxAjFh1Wr8ujw",
            },
            "–ù–æ–∑–æ–∫–æ–º–∏–∞–ª—å–Ω–∞—è –ø–Ω–µ–≤–º–æ–Ω–∏—è": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/yuq7sNfhmpyRew",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/Jp1SSaLGWfaxKw",
            },
            "–°–µ–ø—Å–∏—Å": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/1Guo3RmdBTNuRQ",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/MUttc5OhwEsnDg",
            },
            "–§–∏–±—Ä–∏–ª—å–Ω–∞—è –Ω–µ–π—Ç—Ä–æ–ø–µ–Ω–∏—è": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/x481dlDzDFXneg",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/bebl7x4-K6wQNA",
            },
            "–ò–Ω–≤–∞–∑–∏–≤–Ω—ã–π –∫–∞–Ω–¥–∏–¥–æ–∑": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/CDU-FVaI-rIsqg",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/070K5T2Yzc-0bQ",
            },
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –õ–û–†-–æ—Ä–≥–∞–Ω–æ–≤": {
                "–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/ndGZstmEcgTE4Q",
                "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/RFoMjt4zQ6YKrw",
            },
        }
        if text in AMT_LINKS:
            stack.append(f"amt_{text}")
            if text == "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–æ–≤ –±—Ä—é—à–Ω–æ–π –ø–æ–ª–æ—Å—Ç–∏":
                mk = ReplyKeyboardMarkup(build_menu(AMT_ABD_MENU), resize_keyboard=True)
                await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:", reply_markup=mk)
            else:
                mk = ReplyKeyboardMarkup(build_menu(AMT_SUBMENU), resize_keyboard=True)
                await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:", reply_markup=mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(AMT_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—É–Ω–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.", reply_markup=mk)
        return

    if stack[-1].startswith("amt_"):
        disease = stack[-1][4:]
        AMT_LINKS = { ... }  # —Ç–æ—Ç –∂–µ —Å–ª–æ–≤–∞—Ä—å, —á—Ç–æ –≤—ã—à–µ ‚Äî –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ, –Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –ø–æ–≤—Ç–æ—Ä–∏–º
        AMT_LINKS = {
            "–ò–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–π —ç–Ω–¥–æ–∫–∞—Ä–¥–∏—Ç": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/cOR6sTVnyGIDqQ", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/sA58zTvNdLFWkg"},
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –∫–æ–∂–∏ –∏ –º—è–≥–∫–∏—Ö —Ç–∫–∞–Ω–µ–π": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/o8z1AHFnmVZqUg", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/26jcg2fv6Craqw"},
            "–≠–Ω—Ç–µ—Ä–æ–∫–æ–ª–∏—Ç, –≤—ã–∑–≤–∞–Ω–Ω—ã–π Clostridioides difficille": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/g5gqxtFQRme4rA", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/xk-HSXwQqYz-ZA"},
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–æ–≤ –±—Ä—é—à–Ω–æ–π –ø–æ–ª–æ—Å—Ç–∏": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/yFJ8nMl9iy_TGw", "–≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è —Ç–µ—Ä–∞–ø–∏—è –∏–Ω–≤–∞–∑–∏–≤–Ω–æ–≥–æ –º–∏–∫–æ–∑–∞": "https://disk.yandex.ru/i/_unH6TWjt8FRHg", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/hOk8WzAo8xvAGA"},
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –º–æ—á–µ–≤—ã–≤–æ–¥—è—â–∏—Ö –ø—É—Ç–µ–π": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/gX1wgTfwGjwzvQ", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/GJqNTd6EMpAacw"},
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–æ–≤ –º–∞–ª–æ–≥–æ —Ç–∞–∑–∞": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/QyIlmnkK5UBqTA", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/fSxAjFh1Wr8ujw"},
            "–ù–æ–∑–æ–∫–æ–º–∏–∞–ª—å–Ω–∞—è –ø–Ω–µ–≤–º–æ–Ω–∏—è": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/yuq7sNfhmpyRew", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/Jp1SSaLGWfaxKw"},
            "–°–µ–ø—Å–∏—Å": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/1Guo3RmdBTNuRQ", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/MUttc5OhwEsnDg"},
            "–§–∏–±—Ä–∏–ª—å–Ω–∞—è –Ω–µ–π—Ç—Ä–æ–ø–µ–Ω–∏—è": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/x481dlDzDFXneg", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/bebl7x4-K6wQNA"},
            "–ò–Ω–≤–∞–∑–∏–≤–Ω—ã–π –∫–∞–Ω–¥–∏–¥–æ–∑": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/CDU-FVaI-rIsqg", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/070K5T2Yzc-0bQ"},
            "–ò–Ω—Ñ–µ–∫—Ü–∏—è –õ–û–†-–æ—Ä–≥–∞–Ω–æ–≤": {"–°—Ö–µ–º–∞": "https://disk.yandex.ru/i/ndGZstmEcgTE4Q", "–î–æ–∑–∏—Ä–æ–≤–∫–∏": "https://disk.yandex.ru/i/RFoMjt4zQ6YKrw"},
        }
        if disease in AMT_LINKS and text in AMT_LINKS[disease]:
            link = AMT_LINKS[disease][text]
            await update.message.reply_text(f"üìé {disease} ‚Äî {text}:\n{link}")
        mk = ReplyKeyboardMarkup(build_menu(AMT_MENU), resize_keyboard=True)
        await update.message.reply_text("–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ê–ú–¢:", reply_markup=mk)
        return

    # === –ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫ ===
    if stack[-1] == "hand_hygiene":
        if text == "–í–≤–µ–¥–µ–Ω–∏–µ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–∏–≥–∏–µ–Ω—ã —Ä—É–∫":
            msg = (
                "–ü–æ—á–µ–º—É –≥–∏–≥–∏–µ–Ω–∞ —Ä—É–∫ ‚Äî –æ—Å–Ω–æ–≤–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –æ–∫–∞–∑–∞–Ω–∏–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏ (–ò–°–ú–ü)\n\n"
                "–ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫ —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º–æ–π –ø—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –º–µ—Ä–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –ò–°–ú–ü. \n"
                "–†—É–∫–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ ‚Äî –æ–¥–∏–Ω –∏–∑ –≥–ª–∞–≤–Ω—ã—Ö –ø—É—Ç–µ–π –ø–µ—Ä–µ–¥–∞—á–∏ –ø–∞—Ç–æ–≥–µ–Ω–Ω—ã—Ö –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ –º–µ–∂–¥—É –ø–∞—Ü–∏–µ–Ω—Ç–∞–º–∏, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º –∏ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥–æ–π. –î–∞–∂–µ –ø—Ä–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ —á–∏—Å—Ç–æ–π –∫–æ–∂–µ –Ω–∞ —Ä—É–∫–∞—Ö –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –±–æ–ª–µ–∑–Ω–µ—Ç–≤–æ—Ä–Ω—ã–µ –±–∞–∫—Ç–µ—Ä–∏–∏ (–≤–∫–ª—é—á–∞—è Staphylococcus aureus, Escherichia coli, Clostridioides difficile, –∞ —Ç–∞–∫–∂–µ –º—É–ª—å—Ç–∏—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ —à—Ç–∞–º–º—ã), –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–≥–∫–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø—Ä–∏ –∫–æ–Ω—Ç–∞–∫—Ç–µ.\n\n"
                "–°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–∏–≥–∏–µ–Ω–∞ —Ä—É–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç:\n"
                "‚óè —Å–Ω–∏–∑–∏—Ç—å —Ä–∏—Å–∫ –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–π –æ—Ç –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∫ –ø–∞—Ü–∏–µ–Ω—Ç—É;\n"
                "‚óè –∑–∞—â–∏—Ç–∏—Ç—å —Å–∞–º–æ–≥–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞;\n"
                "‚óè –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –≤—Å–ø—ã—à–∫–∏ –≤–Ω—É—Ç—Ä–∏–±–æ–ª—å–Ω–∏—á–Ω—ã—Ö –∏–Ω—Ñ–µ–∫—Ü–∏–π;\n"
                "‚óè —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ–≤ –∏ –∑–∞–º–µ–¥–ª–∏—Ç—å —Ä–∞–∑–≤–∏—Ç–∏–µ –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.\n\n"
                "–í—Å–µ–º–∏—Ä–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–í–û–ó) –Ω–∞–∑—ã–≤–∞–µ—Ç –≥–∏–≥–∏–µ–Ω—É —Ä—É–∫ ¬´–∑–æ–ª–æ—Ç—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º¬ª –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏."
            )
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await reply_safe(update, msg, mk)
        elif text == "–ü—è—Ç—å –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –≥–∏–≥–∏–µ–Ω—ã —Ä—É–∫ (–ø–æ –í–û–ó)":
            msg = (
                "‚óè –ü–µ—Ä–µ–¥ –∫–æ–Ω—Ç–∞–∫—Ç–æ–º —Å –ø–∞—Ü–∏–µ–Ω—Ç–æ–º\n"
                "‚óè –ü–µ—Ä–µ–¥ —á–∏—Å—Ç–æ–π/–∞—Å–µ–ø—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä–æ–π\n"
                "‚óè –ü–æ—Å–ª–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ –∂–∏–¥–∫–æ—Å—Ç—è–º–∏\n"
                "‚óè –ü–æ—Å–ª–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å –ø–∞—Ü–∏–µ–Ω—Ç–æ–º\n"
                "‚óè –ü–æ—Å–ª–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å –æ–∫—Ä—É–∂–∞—é—â–µ–π –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å—Ä–µ–¥–æ–π"
            )
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await update.message.reply_text(msg, reply_markup=mk)
        elif text == "–ú–µ—Ç–æ–¥–∏–∫–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∏ –≥–∏–≥–∏–µ–Ω—ã —Ä—É–∫":
            stack.append("hand_techniques")
            mk = ReplyKeyboardMarkup(build_menu(HAND_TECHNIQUES_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–æ–¥–∏–∫—É:", reply_markup=mk)
            return
        elif text == "–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤–∞—è –±–∞–∑–∞":
            msg = (
                "1) –ú–£ 3.5.1.3674-20 \"–û–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏–µ —Ä—É–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –∏ –∫–æ–∂–Ω—ã—Ö –ø–æ–∫—Ä–æ–≤–æ–≤ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –æ–∫–∞–∑–∞–Ω–∏–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏\"\n"
                "2) –°–∞–Ω–ü–∏–ù 3.3686-21 \"–°–∞–Ω–∏—Ç–∞—Ä–Ω–æ-—ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–µ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã—Ö –±–æ–ª–µ–∑–Ω–µ–π\"\n"
                "3) –°–û–ü-044-–†–ù-–°–¢ \"–ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫\"\n"
                "4) –°–û–ü-045-–†–ù-–°–¢ \"–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫\""
            )
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await update.message.reply_text(msg, reply_markup=mk)
        elif text == "–û–±—É—á–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å":
            await update.message.reply_text("üìé –û–±—É—á–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å:\nhttps://disk.yandex.ru/i/7JGcNBmtUmwJDg")
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await update.message.reply_text("–ì–∏–≥–∏–µ–Ω–∞ —Ä—É–∫:", reply_markup=mk)
        else:
            mk = ReplyKeyboardMarkup(build_menu(HAND_HYGIENE_MENU), resize_keyboard=True)
            await update.message.reply_text("–ü—É–Ω–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.", reply_markup=mk)
        return

    if stack[-1] == "hand_techniques":
        if text == "–ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫ —Å –º—ã–ª–æ–º –∏ –≤–æ–¥–æ–π / –∞–Ω—Ç–∏—Å–µ–ø—Ç–∏–∫–æ–º":
            await update.message.reply_text("üìπ –í–∏–¥–µ–æ: –ì–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫:\nhttps://disk.yandex.ru/i/K11JJQeKtHdrZA")
        elif text == "–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫":
            await update.message.reply_text("üìπ –í–∏–¥–µ–æ: –•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É–∫:\nhttps://disk.yandex.ru/i/PvnWfDPJYpDmIQ")
        mk = ReplyKeyboardMarkup(build_menu(HAND_TECHNIQUES_MENU), resize_keyboard=True)
        await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–æ–¥–∏–∫—É:", reply_markup=mk)
        return

    # === –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (—Ç–æ–ª—å–∫–æ –†–§) ===
    if stack[-1] == "strat_menu":
        if text == "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ò–ö-–¶–í–ö":
            stack.append("clabsi_context")
            mk = ReplyKeyboardMarkup(build_menu(["–û–ê–†–ò–¢", "–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ", "–û–±—â–µ–ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä"]),
                                     resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:", reply_markup=mk)
        elif text == "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –í–ê–ü":
            stack.append("vap_context")
            mk = ReplyKeyboardMarkup(build_menu(["–û–ê–†–ò–¢", "–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ", "–û–±—â–µ–ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä"]),
                                     resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:", reply_markup=mk)
        elif text == "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ö–ê-–ò–ú–í–ü":
            stack.append("cauti_context")
            mk = ReplyKeyboardMarkup(build_menu(["–û–ê–†–ò–¢", "–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ", "–û–±—â–µ–ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä"]),
                                     resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:", reply_markup=mk)
        elif text == "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ò–û–•–í":
            stack.append("ssi_context")
            types = list(HAI_Calculator.NORMS_RU["ssi"].keys())
            mk = ReplyKeyboardMarkup(build_menu(types), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏:", reply_markup=mk)
        elif text == "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏–Ω—Ñ–µ–∫—Ü–∏—é, –≤—ã–∑–≤–∞–Ω–Ω—É—é Clostridioides difficile":
            stack.append("cdiff_cases")
            await update.message.reply_text("–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ —Å–ª—É—á–∞–µ–≤ –∏–Ω—Ñ–µ–∫—Ü–∏–∏, –≤—ã–∑–≤–∞–Ω–Ω–æ–π Clostridioides difficile:")
        elif text == "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–±—â—É—é —á–∞—Å—Ç–æ—Ç—É –ò–°–ú–ü":
            stack.append("overall_cases")
            await update.message.reply_text("–í–≤–µ–¥–∏—Ç–µ –æ–±—â–µ–µ —á–∏—Å–ª–æ —Å–ª—É—á–∞–µ–≤ –ò–°–ú–ü:")
        else:
            mk = ReplyKeyboardMarkup(build_menu(STRAT_MENU), resize_keyboard=True)
            await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å:", reply_markup=mk)
        return

    # === –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö ===
    if stack[-1].endswith("_context"):
        user_data = context.user_data
        user_data["hai_context"] = text
        indicator = stack[-1].split("_")[0]
        stack[-1] = f"{indicator}_cases"
        await update.message.reply_text(f"–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –Ω–æ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤ {indicator.upper()}:")
        return

    if stack[-1] in ["clabsi_cases", "vap_cases", "cauti_cases", "ssi_cases", "cdiff_cases", "overall_cases"]:
        try:
            cases = int(text)
        except ValueError:
            await update.message.reply_text("‚ùó –í–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ.")
            return
        user_data = context.user_data
        user_data["hai_cases"] = cases
        desc_map = {
            "clabsi_cases": "–∫–∞—Ç–µ—Ç–µ—Ä–æ-–¥–Ω–µ–π –¶–í–ö",
            "vap_cases": "–≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ-–¥–Ω–µ–π",
            "cauti_cases": "–∫–∞—Ç–µ—Ç–µ—Ä–æ-–¥–Ω–µ–π –º–æ—á–µ–≤–æ–≥–æ –∫–∞—Ç–µ—Ç–µ—Ä–∞",
            "ssi_cases": "–æ–ø–µ—Ä–∞—Ü–∏–π",
            "cdiff_cases": "–∫–æ–π–∫–æ-–¥–Ω–µ–π",
            "overall_cases": "–≥–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–π",
        }
        desc = desc_map.get(stack[-1], "–µ–¥–∏–Ω–∏—Ü –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è")
        await update.message.reply_text(f"–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ {desc}:")
        stack[-1] = stack[-1].replace("_cases", "_days")
        return

    # === –†–∞—Å—á—ë—Ç –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è ===
    if stack[-1].endswith("_days"):
        try:
            denom = int(text)
        except ValueError:
            await update.message.reply_text("‚ùó –í–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ.")
            return

        user_data = context.user_data
        cases = user_data["hai_cases"]
        context_name = user_data.get("hai_context")
        calc = HAI_Calculator()
        state = stack[-1]

        if state == "clabsi_days":
            rate = calc.clabsi_rate(cases, denom)
            interpretation = calc.interpret("clabsi", rate, context_name)
            msg = f"‚úÖ –ò–ö-–¶–í–ö: {rate:.2f} –Ω–∞ 1000 –∫–∞—Ç–µ—Ç–µ—Ä–æ-–¥–Ω–µ–π\n{interpretation}"
        elif state == "vap_days":
            rate = calc.vap_rate(cases, denom)
            interpretation = calc.interpret("vap", rate, context_name)
            msg = f"‚úÖ –í–ê–ü: {rate:.2f} –Ω–∞ 1000 –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–æ-–¥–Ω–µ–π\n{interpretation}"
        elif state == "cauti_days":
            rate = calc.cauti_rate(cases, denom)
            interpretation = calc.interpret("cauti", rate, context_name)
            msg = f"‚úÖ –ö–ê-–ò–ú–í–ü: {rate:.2f} –Ω–∞ 1000 –∫–∞—Ç–µ—Ç–µ—Ä–æ-–¥–Ω–µ–π\n{interpretation}"
        elif state == "ssi_days":
            rate = calc.ssi_rate(cases, denom)
            interpretation = calc.interpret("ssi", rate, context_name)
            msg = f"‚úÖ –ò–û–•–í: {rate:.2f}%\n{interpretation}"
        elif state == "cdiff_days":
            rate = calc.c_diff_rate(cases, denom)
            interpretation = calc.interpret("cdiff", rate)
            msg = f"‚úÖ –ò–Ω—Ñ–µ–∫—Ü–∏—è, –≤—ã–∑–≤–∞–Ω–Ω–∞—è Clostridioides difficile: {rate:.2f} –Ω–∞ 10 000 –∫–æ–π–∫–æ-–¥–Ω–µ–π\n{interpretation}"
        elif state == "overall_days":
            rate = calc.overall_hai_rate(cases, denom)
            interpretation = calc.interpret("overall", rate)
            msg = f"‚úÖ –û–±—â–∞—è —á–∞—Å—Ç–æ—Ç–∞ –ò–°–ú–ü: {rate:.2f}% –≥–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–π\n{interpretation}"
        else:
            msg = "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞."

        await update.message.reply_text(msg)
        mk = ReplyKeyboardMarkup(build_menu(STRAT_MENU), resize_keyboard=True)
        await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å:", reply_markup=mk)
        stack.pop()  # –≤–æ–∑–≤—Ä–∞—Ç –≤ strat_menu
        return

    # === –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ===
    await update.message.reply_text("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é.")

# === –ó–ê–ü–£–°–ö ===
def main():
    TOKEN = "8375816364:AAGC6Uy3-Q0Xg5IrQqDrtVXb8PQggsqTpxQ"
    app = Application.builder().token(TOKEN).build()
    app.add_handler(CommandHandler("start", start))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))
    print("‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω. –ù–∞–ø–∏—à–∏—Ç–µ /start")
    app.run_polling()


if __name__ == '__main__':
    main()
